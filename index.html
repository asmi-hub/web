<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ü•∑ Âº±Ê∞¥‰∏âÂçÉÂè™Âèñ‰∏ÄÁì¢</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        /* ========== È°µÈù¢Âä†ËΩΩÂä®Áîª ========== */
        #page-loading {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: var(--bg-dark, #0f172a);
            z-index: 9999;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            transition: opacity 0.5s ease, visibility 0.5s ease;
        }

        #page-loading.hidden {
            opacity: 0;
            visibility: hidden;
        }

        .loading-logo {
            font-size: 3rem;
            color: var(--primary-color, #6366f1);
            margin-bottom: 2rem;
            animation: pulse 2s infinite;
        }

        .loading-text {
            color: var(--text-primary, #f1f5f9);
            font-size: 1.2rem;
            margin-bottom: 2rem;
            text-align: center;
        }

        .loading-spinner-container {
            position: relative;
            width: 80px;
            height: 80px;
        }

        .spinner-circle {
            position: absolute;
            width: 100%;
            height: 100%;
            border-radius: 50%;
            border: 4px solid transparent;
        }

        .spinner-circle-outer {
            border-top: 4px solid var(--primary-color, #6366f1);
            border-right: 4px solid var(--primary-color, #6366f1);
            border-bottom: 4px solid transparent;
            border-left: 4px solid transparent;
            animation: spin 1s linear infinite;
        }

        .spinner-circle-inner {
            top: 10px;
            left: 10px;
            width: 60px;
            height: 60px;
            border-top: 4px solid var(--secondary-color, #8b5cf6);
            border-right: 4px solid var(--secondary-color, #8b5cf6);
            border-bottom: 4px solid transparent;
            border-left: 4px solid transparent;
            animation: spin 0.8s linear infinite reverse;
        }

        .loading-progress {
            margin-top: 1.5rem;
            width: 200px;
            height: 4px;
            background-color: rgba(255, 255, 255, 0.1);
            border-radius: 2px;
            overflow: hidden;
        }

        .loading-progress-bar {
            height: 100%;
            width: 0%;
            background: linear-gradient(90deg, var(--primary-color, #6366f1), var(--secondary-color, #8b5cf6));
            border-radius: 2px;
            transition: width 0.3s ease;
        }

        @keyframes pulse {
            0% {
                transform: scale(1);
                opacity: 1;
            }
            50% {
                transform: scale(1.05);
                opacity: 0.8;
            }
            100% {
                transform: scale(1);
                opacity: 1;
            }
        }

        @keyframes spin {
            0% {
                transform: rotate(0deg);
            }
            100% {
                transform: rotate(360deg);
            }
        }

        /* ÊâãÊú∫Á´Ø‰ºòÂåñ */
        @media (max-width: 768px) {
            .loading-logo {
                font-size: 2.5rem;
                margin-bottom: 1.5rem;
            }

            .loading-text {
                font-size: 1rem;
                margin-bottom: 1.5rem;
                padding: 0 20px;
            }

            .loading-spinner-container {
                width: 60px;
                height: 60px;
            }

            .spinner-circle-inner {
                top: 8px;
                left: 8px;
                width: 44px;
                height: 44px;
            }

            .loading-progress {
                width: 180px;
            }
        }

        @media (max-width: 480px) {
            .loading-logo {
                font-size: 2rem;
                margin-bottom: 1.2rem;
            }

            .loading-text {
                font-size: 0.9rem;
                margin-bottom: 1.2rem;
            }

            .loading-spinner-container {
                width: 50px;
                height: 50px;
            }

            .spinner-circle-inner {
                top: 6px;
                left: 6px;
                width: 38px;
                height: 38px;
            }

            .loading-progress {
                width: 160px;
            }
        }

        /* ========== ÂéüÊúâÊ†∑Âºè ========== */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', 'Microsoft YaHei', sans-serif;
        }
        
        :root {
            --primary-color: #6366f1;
            --primary-dark: #4f46e5;
            --bg-dark: #0f172a;
            --bg-card: #1e293b;
            --bg-card-light: #334155;
            --text-primary: #f1f5f9;
            --text-secondary: #94a3b8;
            --border-color: #475569;
            --shadow-color: rgba(0, 0, 0, 0.3);
            --success-color: #10b981;
            --warning-color: #f59e0b;
            --collapse-color: #ef4444; /* Êñ∞Â¢ûÔºöÊäòÂè†ÊåâÈíÆÈ¢úËâ≤ */
            --secondary-color: #8b5cf6;
            --darker-bg: #020617;
            --text-muted: #64748b;
            --shadow-sm: 0 1px 2px 0 rgba(0, 0, 0, 0.5);
            --shadow-md: 0 4px 6px -1px rgba(0, 0, 0, 0.7);
            --shadow-lg: 0 10px 15px -3px rgba(0, 0, 0, 0.8);
            --shadow-xl: 0 20px 25px -5px rgba(0, 0, 0, 0.9);
            --gradient-primary: linear-gradient(135deg, #6366f1, #8b5cf6);
            --gradient-dark: linear-gradient(135deg, #1e293b, #0f172a);
            --radius-sm: 8px;
            --radius-md: 12px;
            --radius-lg: 16px;
            --radius-xl: 24px;
        }
        
        body {
            background-color: var(--bg-dark);
            color: var(--text-primary);
            line-height: 1.6;
            padding: 16px;
            min-height: 100vh;
            background-image: 
                radial-gradient(circle at 20% 30%, rgba(99, 102, 241, 0.1) 0%, transparent 50%),
                radial-gradient(circle at 80% 70%, rgba(79, 70, 229, 0.08) 0%, transparent 50%);
        }
        
        /* Ê¨¢ËøéÂºπÁ™óÊ†∑Âºè */
        .welcome-modal {
            display: flex; /* Êîπ‰∏∫flexÔºåÈªòËÆ§ÊòæÁ§∫ */
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: rgba(15, 23, 42, 0.9);
            z-index: 1000;
            justify-content: center;
            align-items: center;
            backdrop-filter: blur(5px);
        }
        
        .welcome-modal.hidden {
            display: none; /* ‰ΩøÁî®hiddenÁ±ªÊù•ÈöêËóè */
        }
        
        .modal-content {
            background-color: var(--bg-card);
            border-radius: 20px;
            padding: 40px;
            max-width: 500px;
            width: 90%;
            box-shadow: 0 20px 50px rgba(0, 0, 0, 0.5);
            text-align: center;
            border: 2px solid var(--primary-color);
            animation: modalAppear 0.5s ease-out;
        }
        
        @keyframes modalAppear {
            from {
                opacity: 0;
                transform: translateY(-30px) scale(0.95);
            }
            to {
                opacity: 1;
                transform: translateY(0) scale(1);
            }
        }
        
        .modal-icon {
            font-size: 4rem;
            color: var(--primary-color);
            margin-bottom: 20px;
        }
        
        .modal-title {
            font-size: 2rem;
            color: var(--text-primary);
            margin-bottom: 10px;
        }
        
        .modal-subtitle {
            color: var(--text-secondary);
            font-size: 1.1rem;
            margin-bottom: 30px;
            line-height: 1.5;
        }
        
        .modal-buttons {
            display: flex;
            flex-direction: column;
            gap: 16px;
            margin-top: 30px;
        }
        
        .modal-btn {
            padding: 18px 30px;
            border: none;
            border-radius: 14px;
            font-size: 1.2rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 12px;
            box-shadow: 0 6px 20px rgba(0, 0, 0, 0.2);
        }
        
        .modal-btn.inspection {
            background-color: var(--success-color);
            color: white;
        }
        
        .modal-btn.inspection:hover {
            background-color: #0da271;
            transform: translateY(-4px);
            box-shadow: 0 10px 25px rgba(16, 185, 129, 0.4);
        }
        
        .modal-btn.clock {
            background-color: var(--primary-color);
            color: white;
        }
        
        .modal-btn.clock:hover {
            background-color: var(--primary-dark);
            transform: translateY(-4px);
            box-shadow: 0 10px 25px rgba(99, 102, 241, 0.4);
        }
        
        .modal-btn i {
            font-size: 1.3rem;
        }
        
        /* ÊâìÂç°ÂºπÁ™óÊ†∑Âºè */
        .clock-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: rgba(15, 23, 42, 0.95);
            z-index: 1001;
            justify-content: center;
            align-items: center;
            backdrop-filter: blur(5px);
        }
        
        .clock-modal.active {
            display: flex;
        }
        
        .clock-modal-content {
            background-color: var(--bg-card);
            border-radius: 20px;
            padding: 30px;
            max-width: 400px;
            width: 90%;
            box-shadow: 0 20px 50px rgba(0, 0, 0, 0.5);
            text-align: center;
            border: 2px solid var(--success-color);
            animation: modalAppear 0.5s ease-out;
        }
        
        .clock-modal-header {
            margin-bottom: 25px;
        }
        
        .clock-modal-title {
            font-size: 1.8rem;
            color: var(--text-primary);
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 12px;
        }
        
        .clock-modal-subtitle {
            color: var(--text-secondary);
            font-size: 1rem;
        }
        
        .clock-qr-container {
            background-color: var(--bg-card-light);
            border-radius: 16px;
            padding: 20px;
            margin: 20px 0;
            display: flex;
            justify-content: center;
            align-items: center;
            border: 2px solid var(--border-color);
        }
        
        .clock-qr-placeholder {
            width: 250px;
            height: 250px;
            background-color: white;
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            overflow: hidden;
            padding: 10px;
        }
        
        .clock-qr-placeholder img {
            width: 100%;
            height: 100%;
            object-fit: contain;
        }
        
        .clock-info {
            margin: 20px 0;
            text-align: center;
        }
        
        .clock-code {
            font-family: 'Courier New', monospace;
            background-color: rgba(0, 0, 0, 0.3);
            padding: 12px;
            border-radius: 10px;
            font-size: 0.9rem;
            color: var(--text-primary);
            margin-bottom: 15px;
            border: 1px solid var(--border-color);
        }
        
        .clock-url {
            font-size: 0.8rem;
            color: var(--text-secondary);
            word-break: break-all;
            background-color: rgba(0, 0, 0, 0.2);
            padding: 10px;
            border-radius: 8px;
            border: 1px solid var(--border-color);
        }
        
        .clock-modal-buttons {
            margin-top: 25px;
        }
        
        .clock-close-btn {
            padding: 14px 30px;
            background-color: var(--bg-card-light);
            border: none;
            border-radius: 12px;
            color: var(--text-primary);
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            width: 100%;
            font-size: 1rem;
        }
        
        .clock-close-btn:hover {
            background-color: var(--border-color);
            transform: translateY(-3px);
        }
        
        /* ËΩ¶Èó¥ÈÄâÊã©ÂºπÁ™ó */
        .facility-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: rgba(15, 23, 42, 0.95);
            z-index: 1002;
            justify-content: center;
            align-items: center;
            backdrop-filter: blur(5px);
        }
        
        .facility-modal.active {
            display: flex;
        }
        
        .facility-modal-content {
            background-color: var(--bg-card);
            border-radius: 20px;
            padding: 30px;
            max-width: 900px;
            width: 95%;
            max-height: 85vh;
            box-shadow: 0 20px 50px rgba(0, 0, 0, 0.5);
            display: flex;
            flex-direction: column;
            border: 2px solid var(--primary-color);
            animation: modalAppear 0.5s ease-out;
        }
        
        .facility-modal-header {
            margin-bottom: 25px;
            text-align: center;
            position: relative;
        }
        
        .facility-modal-title {
            font-size: 1.8rem;
            color: var(--text-primary);
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 12px;
        }
        
        .facility-modal-subtitle {
            color: var(--text-secondary);
            font-size: 1rem;
        }
        
        .facility-close-btn {
            position: absolute;
            top: 0;
            right: 0;
            background-color: var(--bg-card-light);
            border: none;
            border-radius: 10px;
            color: var(--text-primary);
            width: 40px;
            height: 40px;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.2rem;
        }
        
        .facility-close-btn:hover {
            background-color: var(--border-color);
            transform: translateY(-3px);
        }
        
        .facility-buttons-container {
            flex: 1;
            overflow-y: auto;
            padding-right: 5px;
        }
        
        .facility-buttons-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(180px, 1fr));
            gap: 18px;
        }
        
        .facility-btn {
            padding: 20px 15px;
            background-color: var(--bg-card-light);
            border: none;
            border-radius: 12px;
            color: var(--text-primary);
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            text-align: center;
            font-size: 1.1rem;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            min-height: 100px;
            position: relative;
            overflow: hidden;
        }
        
        .facility-btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 3px;
            background: var(--primary-color);
            transform: scaleX(0);
            transition: transform 0.3s ease;
        }
        
        .facility-btn:hover {
            background-color: var(--primary-color);
            transform: translateY(-6px);
            box-shadow: 0 8px 25px rgba(99, 102, 241, 0.3);
        }
        
        .facility-btn:hover::before {
            transform: scaleX(1);
        }
        
        .facility-btn.active {
            background-color: var(--primary-color);
            color: white;
            box-shadow: 0 6px 20px rgba(99, 102, 241, 0.4);
        }
        
        .facility-btn.active::before {
            transform: scaleX(1);
        }
        
        /* ÁßªÈô§Ë∂ÖÁ∫≤ËÆæÊñΩÁ†ÅÁöÑÁâπÊÆäÊ†∑Âºè */
        .facility-btn .type-tag {
            font-size: 0.8rem;
            background: rgba(255, 255, 255, 0.15);
            padding: 4px 12px;
            border-radius: 10px;
            margin-top: 10px;
            font-weight: normal;
        }
        
        /* ‰∏ªÂÜÖÂÆπ - ‰∫åÁª¥Á†ÅÂ±ïÁ§∫È°µÈù¢ */
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0;
            display: none;
        }
        
        .container.active {
            display: block;
        }
        
        .content {
            display: flex;
            flex-direction: column;
            gap: 24px;
        }
        
        .qr-display {
            background-color: var(--bg-card);
            border-radius: 16px;
            padding: 24px 16px;
            box-shadow: 0 8px 25px var(--shadow-color);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            position: relative;
        }
        
        .qr-display h2 {
            color: var(--text-primary);
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 2px solid var(--border-color);
            width: 100%;
            text-align: center;
            font-size: 1.3rem;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 12px;
        }
        
        .qr-display-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            width: 100%;
            margin-bottom: 20px;
            flex-wrap: wrap;
            gap: 12px;
        }
        
        /* ËøîÂõûÈÄâÊã©ÊåâÈíÆ - Áã¨Á´ãÊ†∑Âºè */
        .back-to-facility-container {
            position: absolute;
            top: 24px;
            left: 24px;
            z-index: 10;
        }
        
        .back-to-facility-btn {
            padding: 12px 20px;
            border: none;
            border-radius: 10px;
            background-color: var(--bg-card-light);
            color: var(--text-primary);
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            font-size: 0.95rem;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
            white-space: nowrap;
        }
        
        .back-to-facility-btn:hover {
            background-color: var(--primary-color);
            color: white;
            transform: translateY(-3px);
            box-shadow: 0 6px 18px rgba(99, 102, 241, 0.4);
        }
        
        .back-to-facility-btn i {
            font-size: 1rem;
        }
        
        /* ‰∫åÁª¥Á†ÅÂÆπÂô® - Ê∑ªÂä†ÁÇπÂáªÊïàÊûú */
        .qr-code-container {
            background-color: var(--bg-card-light);
            border-radius: 16px;
            padding: 24px;
            width: 100%;
            max-width: 320px;
            display: flex;
            flex-direction: column;
            align-items: center;
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.2);
            margin-bottom: 10px;
            margin-top: 10px;
            transition: all 0.3s ease;
            cursor: pointer;
            position: relative;
        }
        
        .qr-code-container:hover {
            transform: translateY(-5px);
            box-shadow: 0 12px 25px rgba(0, 0, 0, 0.3);
        }
        
        .qr-code-container.facility-mode-active {
            border: 2px solid var(--primary-color);
            box-shadow: 0 12px 30px rgba(99, 102, 241, 0.3);
        }
        
        .qr-placeholder {
            width: 100%;
            max-width: 280px;
            height: 280px;
            background-color: white;
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-bottom: 20px;
            border: 2px solid var(--border-color);
            overflow: hidden;
            position: relative;
            padding: 10px;
            transition: all 0.3s ease;
        }
        
        .qr-placeholder:hover {
            border-color: var(--primary-color);
        }
        
        .qr-placeholder img {
            width: 100%;
            height: 100%;
            object-fit: contain;
        }
        
        /* ËÆæÊñΩÁ†ÅÊ®°ÂºèÊèêÁ§∫ */
        .facility-mode-hint {
            position: absolute;
            top: -10px;
            left: 50%;
            transform: translateX(-50%);
            background-color: var(--primary-color);
            color: white;
            padding: 6px 15px;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: 600;
            box-shadow: 0 4px 12px rgba(99, 102, 241, 0.4);
            z-index: 5;
            display: none;
        }
        
        .qr-code-container.facility-mode-active .facility-mode-hint {
            display: block;
        }
        
        .qr-info {
            text-align: center;
            width: 100%;
        }
        
        .qr-title {
            font-size: 1.3rem;
            color: var(--text-primary);
            margin-bottom: 12px;
            font-weight: 700;
            line-height: 1.4;
            padding: 0 10px;
        }
        
        .qr-code {
            font-family: 'Courier New', monospace;
            background-color: rgba(0, 0, 0, 0.3);
            padding: 12px;
            border-radius: 10px;
            margin: 16px 0;
            font-size: 0.9rem;
            color: var(--text-primary);
            letter-spacing: 1px;
            overflow-x: auto;
            white-space: nowrap;
            width: 100%;
            border: 1px solid var(--border-color);
        }
        
        .qr-url-container {
            margin: 16px 0;
            width: 100%;
        }
        
        .qr-url-label {
            font-size: 0.9rem;
            color: var(--text-secondary);
            margin-bottom: 8px;
            text-align: left;
        }
        
        .qr-url {
            font-family: 'Courier New', monospace;
            background-color: rgba(0, 0, 0, 0.3);
            padding: 12px;
            border-radius: 10px;
            font-size: 0.75rem;
            color: var(--text-primary);
            word-break: break-all;
            max-height: 100px;
            overflow-y: auto;
            width: 100%;
            text-align: left;
            border: 1px solid var(--border-color);
            line-height: 1.5;
        }
        
        .instruction {
            color: var(--text-secondary);
            font-size: 0.9rem;
            margin-top: 16px;
            text-align: center;
            padding: 0 10px;
        }
        
        .loading {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            height: 100%;
            width: 100%;
        }
        
        .loading-spinner {
            width: 50px;
            height: 50px;
            border: 4px solid rgba(255, 255, 255, 0.1);
            border-top: 4px solid var(--primary-color);
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin-bottom: 16px;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        .action-buttons {
            display: flex;
            gap: 12px;
            margin-top: 20px;
            width: 100%;
            justify-content: center;
            max-width: 300px;
        }
        
        .action-btn {
            padding: 14px 24px;
            border: none;
            border-radius: 12px;
            background-color: var(--primary-color);
            color: white;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            flex: 1;
            max-width: 200px;
            font-size: 1rem;
            box-shadow: 0 4px 12px rgba(99, 102, 241, 0.3);
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }
        
        .action-btn:hover {
            background-color: var(--primary-dark);
            transform: translateY(-3px);
            box-shadow: 0 6px 18px rgba(99, 102, 241, 0.4);
        }
        
        .action-btn.next {
            background-color: var(--success-color);
        }
        
        .action-btn.next:hover {
            background-color: #0da271;
        }
        
        .action-btn:disabled {
            background-color: var(--border-color);
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }
        
        footer {
            margin-top: 30px;
            text-align: center;
            color: var(--text-secondary);
            font-size: 0.85rem;
            padding-top: 20px;
            border-top: 1px solid var(--border-color);
        }
        
        /* ============== ‰øÆÊîπÂêéÁöÑËΩ¶Èó¥‰∫åÁª¥Á†ÅÊâ´ÊèèÁ≥ªÁªüÈ°µÈù¢Ê†∑Âºè ============== */
        .qr-scan-system {
            display: none;
            max-width: 1200px;
            margin: 0 auto;
            padding: 0;
        }
        
        .qr-scan-system.active {
            display: block;
        }
        
        /* ÁßªÈô§ÈªëËâ≤Ê®™ÂπÖÂ§¥ÈÉ®Ê†∑Âºè */
        .qr-scan-header {
            background: transparent;
            border-bottom: none;
            padding: 10px 0 20px 0;
            position: relative;
            top: 0;
            z-index: 10;
            margin-bottom: 24px;
        }
        
        .qr-scan-header-content {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 16px;
            display: flex;
            flex-direction: column;
            gap: 16px;
        }
        
        .qr-scan-title-section {
            text-align: center;
            background-color: var(--bg-card);
            border-radius: var(--radius-xl);
            padding: 24px 20px;
            box-shadow: var(--shadow-lg);
            border: 1px solid var(--border-color);
        }
        
        .qr-scan-main-title {
            font-size: 28px;
            font-weight: 800;
            background: var(--gradient-primary);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin-bottom: 8px;
            letter-spacing: -0.5px;
        }
        
        .qr-scan-subtitle {
            font-size: 14px;
            color: var(--text-secondary);
            opacity: 0.9;
        }
        
        /* ÊéßÂà∂ÊåâÈíÆÂå∫Âüü */
        .qr-scan-controls-section {
            display: flex;
            justify-content: center;
            gap: 16px;
            margin-top: 8px;
            background-color: var(--bg-card);
            border-radius: var(--radius-lg);
            padding: 16px;
            box-shadow: var(--shadow-md);
            border: 1px solid var(--border-color);
        }
        
        /* ‰ΩøÁî®Áªü‰∏ÄÁöÑÊéßÂà∂ÊåâÈíÆÊ†∑Âºè */
        .control-btn {
            background: var(--bg-card-light);
            border: 1px solid var(--border-color);
            color: var(--text-primary);
            padding: 12px 24px;
            border-radius: var(--radius-lg);
            font-weight: 600;
            font-size: 14px;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 8px;
            box-shadow: var(--shadow-sm);
        }
        
        .control-btn:hover {
            background: var(--primary-color);
            border-color: var(--primary-color);
            transform: translateY(-2px);
            box-shadow: var(--shadow-md);
        }
        
        .control-btn:active {
            transform: translateY(0);
        }
        
        .control-btn i {
            font-size: 16px;
        }
        
        /* ‰øÆÊîπÔºöÂÖ®ÈÉ®ÊäòÂè†ÊåâÈíÆÈ¢úËâ≤ */
        .control-btn.collapse-all {
            background-color: var(--collapse-color);
            border-color: var(--collapse-color);
            color: white;
        }
        
        .control-btn.collapse-all:hover {
            background-color: #dc2626;
            border-color: #dc2626;
        }
        
        .control-btn.back {
            background-color: var(--bg-card-light);
            color: var(--text-primary);
        }
        
        .control-btn.back:hover {
            background-color: var(--primary-color);
            border-color: var(--primary-color);
            color: white;
        }
        
        /* ÂàÜÁ±ªÊäòÂè†Âå∫Âüü */
        .qr-scan-main-content {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 16px;
            display: flex;
            flex-direction: column;
            gap: 16px;
            padding-bottom: 32px;
        }
        
        .category-collapse {
            background: var(--bg-card);
            border-radius: var(--radius-xl);
            overflow: hidden;
            box-shadow: var(--shadow-lg);
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            border: 1px solid var(--border-color);
        }
        
        .category-collapse:hover {
            box-shadow: var(--shadow-xl);
            transform: translateY(-2px);
        }
        
        /* ÊäòÂè†ÊåâÈíÆÊ†∑Âºè */
        .collapse-btn {
            width: 100%;
            background: transparent;
            border: none;
            padding: 18px 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            cursor: pointer;
            transition: background-color 0.3s ease;
        }
        
        .collapse-btn:hover {
            background: rgba(255, 255, 255, 0.05);
        }
        
        .category-header {
            display: flex;
            align-items: center;
            gap: 16px;
        }
        
        /* ÂàÜÁ±ªÂõæÊ†á */
        .category-icon {
            width: 40px;
            height: 40px;
            background: var(--gradient-primary);
            border-radius: var(--radius-md);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 20px;
            color: white;
            box-shadow: 0 4px 12px rgba(99, 102, 241, 0.3);
        }
        
        /* ÂàÜÁ±ªÊ†áÈ¢ò */
        .category-title {
            font-size: 18px;
            font-weight: 700;
            color: var(--text-primary);
        }
        
        .category-count {
            background: var(--bg-dark);
            color: var(--text-secondary);
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 14px;
            font-weight: 600;
            margin-left: 12px;
        }
        
        /* ÊäòÂè†ÊåáÁ§∫Âô® */
        .collapse-indicator {
            color: var(--text-secondary);
            font-size: 20px;
            transition: transform 0.4s cubic-bezier(0.4, 0, 0.2, 1);
        }
        
        .collapse-btn.collapsed .collapse-indicator {
            transform: rotate(-90deg);
        }
        
        /* ÊäòÂè†ÂÜÖÂÆπÂå∫Âüü */
        .collapse-content {
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.5s cubic-bezier(0.4, 0, 0.2, 1);
            background: var(--bg-dark);
        }
        
        .collapse-content.expanded {
            max-height: 5000px;
            border-top: 1px solid var(--border-color);
        }
        
        /* Â≠êÂàÜÁ±ªÊ†∑Âºè */
        .subcategory {
            padding: 24px;
            border-bottom: 1px solid var(--border-color);
        }
        
        .subcategory:last-child {
            border-bottom: none;
        }
        
        .subcategory-header {
            display: flex;
            align-items: center;
            gap: 12px;
            margin-bottom: 20px;
            padding-bottom: 12px;
            border-bottom: 1px solid var(--border-color);
        }
        
        .subcategory-icon {
            width: 32px;
            height: 32px;
            background: var(--gradient-primary);
            border-radius: var(--radius-md);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 16px;
            color: white;
        }
        
        .subcategory-title {
            font-size: 18px;
            font-weight: 600;
            color: var(--text-primary);
        }
        
        /* ‰∫åÁª¥Á†ÅÁΩëÊ†º - ‰ΩøÁî®index0.htmlÁöÑÂ±ïÁ§∫ÊïàÊûú */
        .qr-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
            gap: 20px;
        }
        
        .qr-item {
            background: var(--bg-card);
            border-radius: var(--radius-lg);
            padding: 20px;
            transition: all 0.3s ease;
            border: 1px solid var(--border-color);
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 16px;
            box-shadow: var(--shadow-md);
        }
        
        .qr-item:hover {
            transform: translateY(-4px);
            box-shadow: var(--shadow-xl);
            background: var(--bg-card-light);
            border-color: var(--primary-color);
        }
        
        .qr-code-container-new {
            position: relative;
            width: 160px;
            height: 160px;
            background: white;
            border-radius: var(--radius-md);
            padding: 12px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
        }
        
        .qr-code-img {
            width: 100%;
            height: 100%;
            border-radius: var(--radius-sm);
            object-fit: contain;
        }
        
        .qr-overlay {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(15, 23, 42, 0.9);
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: var(--radius-md);
            opacity: 0;
            transition: opacity 0.3s ease;
        }
        
        .qr-item:hover .qr-overlay {
            opacity: 1;
        }
        
        .qr-info-new {
            text-align: center;
            width: 100%;
        }
        
        .qr-label {
            font-size: 16px;
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: 6px;
        }
        
        .qr-desc {
            font-size: 13px;
            color: var(--text-secondary);
            line-height: 1.4;
        }
        
        /* È°µËÑö */
        .qr-scan-footer {
            background: var(--bg-dark);
            border-top: 1px solid var(--border-color);
            padding: 24px 0;
            margin-top: 48px;
        }
        
        .qr-scan-footer-content {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 16px;
            text-align: center;
            color: var(--text-secondary);
            font-size: 14px;
        }
        
        /* ÊèêÁ§∫‰ø°ÊÅØ */
        .toast {
            position: fixed;
            bottom: 24px;
            left: 50%;
            transform: translateX(-50%) translateY(100px);
            background: var(--bg-card);
            color: var(--text-primary);
            padding: 16px 24px;
            border-radius: var(--radius-lg);
            box-shadow: var(--shadow-xl);
            border: 1px solid var(--border-color);
            z-index: 1000;
            opacity: 0;
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            max-width: 400px;
            width: 90%;
        }
        
        .toast.show {
            transform: translateX(-50%) translateY(0);
            opacity: 1;
        }
        
        /* ÊâãÊú∫‰ºòÂåñ */
        @media (max-width: 768px) {
            body {
                padding: 12px;
            }
            
            .modal-content {
                padding: 30px 20px;
            }
            
            .modal-title {
                font-size: 1.7rem;
            }
            
            .modal-btn {
                padding: 16px 20px;
                font-size: 1.1rem;
            }
            
            .clock-modal-content {
                padding: 25px 20px;
            }
            
            .clock-modal-title {
                font-size: 1.5rem;
            }
            
            .clock-qr-placeholder {
                width: 220px;
                height: 220px;
            }
            
            .facility-modal-content {
                padding: 20px 15px;
                max-width: 95%;
            }
            
            .facility-buttons-grid {
                grid-template-columns: repeat(auto-fill, minmax(140px, 1fr));
                gap: 14px;
            }
            
            .facility-btn {
                padding: 16px 12px;
                font-size: 1rem;
                min-height: 90px;
            }
            
            .qr-display {
                padding: 24px 12px;
            }
            
            /* ÁßªÂä®Á´ØË∞ÉÊï¥ÊåâÈíÆ‰ΩçÁΩÆ */
            .back-to-facility-container {
                position: relative;
                top: auto;
                left: auto;
                margin-bottom: 15px;
                width: 100%;
            }
            
            .back-to-facility-btn {
                width: 100%;
                justify-content: center;
            }
            
            .qr-code-container {
                padding: 20px 16px;
                margin-top: 10px;
            }
            
            .qr-placeholder {
                max-width: 260px;
                height: 260px;
            }
            
            .qr-title {
                font-size: 1.2rem;
            }
            
            .qr-code {
                font-size: 0.85rem;
                padding: 10px;
            }
            
            .qr-url {
                font-size: 0.7rem;
                padding: 10px;
            }
            
            .action-btn {
                padding: 12px 20px;
                font-size: 0.95rem;
            }
            
            /* ‰∫åÁª¥Á†ÅÊâ´ÊèèÁ≥ªÁªüÂìçÂ∫îÂºè */
            .qr-scan-header-content {
                padding: 0 12px;
            }
            
            .qr-scan-main-title {
                font-size: 24px;
            }
            
            .qr-scan-controls-section {
                flex-direction: column;
                align-items: stretch;
                padding: 12px;
            }
            
            .control-btn {
                justify-content: center;
                width: 100%;
            }
            
            .qr-grid {
                grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
            }
            
            .category-header {
                gap: 12px;
            }
            
            .category-icon {
                width: 36px;
                height: 36px;
                font-size: 18px;
            }
            
            .category-title {
                font-size: 16px;
            }
            
            .collapse-btn {
                padding: 16px 18px;
            }
            
            .qr-scan-main-content {
                padding: 0 12px;
            }
        }
        
        @media (max-width: 480px) {
            .modal-content {
                padding: 25px 15px;
            }
            
            .modal-title {
                font-size: 1.5rem;
            }
            
            .modal-subtitle {
                font-size: 1rem;
            }
            
            .modal-btn {
                padding: 14px 16px;
                font-size: 1rem;
            }
            
            .clock-qr-placeholder {
                width: 200px;
                height: 200px;
            }
            
            .facility-buttons-grid {
                grid-template-columns: repeat(2, 1fr);
            }
            
            .facility-btn .type-tag {
                font-size: 0.75rem;
                padding: 3px 8px;
            }
            
            .qr-placeholder {
                max-width: 240px;
                height: 240px;
            }
            
            .action-buttons {
                flex-direction: column;
                align-items: center;
            }
            
            .action-btn {
                max-width: 100%;
                width: 100%;
            }
            
            /* ‰∫åÁª¥Á†ÅÊâ´ÊèèÁ≥ªÁªüÂìçÂ∫îÂºè */
            .qr-grid {
                grid-template-columns: 1fr;
            }
            
            .collapse-btn {
                padding: 14px 16px;
            }
            
            .subcategory {
                padding: 16px;
            }
            
            .qr-code-container-new {
                width: 140px;
                height: 140px;
            }
            
            .qr-scan-controls-section {
                flex-direction: column;
            }
            
            .qr-scan-title-section {
                padding: 20px 16px;
            }
            
            .qr-scan-main-title {
                font-size: 22px;
            }
        }
        
        /* ÊªöÂä®Êù°Ê†∑Âºè */
        ::-webkit-scrollbar {
            width: 6px;
            height: 6px;
        }
        
        ::-webkit-scrollbar-track {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 3px;
        }
        
        ::-webkit-scrollbar-thumb {
            background: var(--primary-color);
            border-radius: 3px;
        }
        
        ::-webkit-scrollbar-thumb:hover {
            background: var(--primary-dark);
        }
        
        /* ‰∫åÁª¥Á†ÅÂÆπÂô®‰ºòÂåñÔºåÁ°Æ‰øùÊó†ÈÅÆÊå° */
        .qr-code-wrapper {
            position: relative;
            width: 100%;
            display: flex;
            justify-content: center;
        }
    </style>
</head>
<body>
    <!-- È°µÈù¢Âä†ËΩΩÂä®Áîª -->
    <div id="page-loading">
        <div class="loading-logo">
            <i class="fas fa-shield-alt"></i>
        </div>
        <div class="loading-text"><br>Ê≠£Âú®Âä†ËΩΩÔºåËØ∑Á®çÂÄô...</div>
        <div class="loading-spinner-container">
            <div class="spinner-circle spinner-circle-outer"></div>
            <div class="spinner-circle spinner-circle-inner"></div>
        </div>
        <div class="loading-progress">
            <div class="loading-progress-bar" id="loading-progress-bar"></div>
        </div>
    </div>
    
    <!-- Ê¨¢ËøéÂºπÁ™ó -->
    <div class="welcome-modal" id="welcomeModal">
        <div class="modal-content">
            <div class="modal-icon">
                <i class="fas fa-shield-alt"></i>
            </div>
            <h1 class="modal-title">Ê∂àÈò≤ËÆæÊñΩÂ∑°Êü•Á≥ªÁªü</h1>
            <p class="modal-subtitle">KingLong Ê∂àÈò≤ËÆæÊñΩÂ∑°Êü•Á≥ªÁªü<br>‚ô®Ô∏è ‰ΩéË∞É‰ΩøÁî®</p>
            
            <div class="modal-buttons">
                <button class="modal-btn inspection" id="startInspectionBtn">
                    <i class="fas fa-search"></i> ÂºÄÂßãÂ∑°Êü•‰ªªÂä°
                </button>
                <button class="modal-btn clock" id="clockInOutBtn">
                    <i class="fas fa-user-clock"></i> ‰∏ä‰∏ãÁè≠ÊâìÂç°
                </button>
            </div>
        </div>
    </div>
    
    <!-- ÊâìÂç°ÂºπÁ™ó -->
    <div class="clock-modal" id="clockModal">
        <div class="clock-modal-content">
            <div class="clock-modal-header">
                <h2 class="clock-modal-title">
                    <i class="fas fa-user-clock"></i> ‰∏ä‰∏ãÁè≠ÊâìÂç°
                </h2>
                <p class="clock-modal-subtitle">ËØ∑Êâ´Êèè‰∏ãÊñπ‰∫åÁª¥Á†ÅËøõË°å‰∏ä‰∏ãÁè≠ÊâìÂç°</p>
            </div>
            
            <div class="clock-qr-container">
                <div class="clock-qr-placeholder" id="clockQrPlaceholder">
                    <div class="loading">
                        <div class="loading-spinner"></div>
                        <p>Ê≠£Âú®ÁîüÊàêÊâìÂç°‰∫åÁª¥Á†Å...</p>
                    </div>
                </div>
            </div>
            
            <div class="clock-info">
                <div class="clock-code" id="clockCodeText">S0000007287810</div>
                <div class="clock-url" id="clockUrlText">https://zhxf.fj.119.gov.cn:8081/xgj/gzfw?qr=S0000007287810</div>
            </div>
            
            <div class="clock-modal-buttons">
                <button class="clock-close-btn" id="closeClockModalBtn">
                    <i class="fas fa-times"></i> ÂÖ≥Èó≠
                </button>
            </div>
        </div>
    </div>
    
    <!-- ËΩ¶Èó¥ÈÄâÊã©ÂºπÁ™ó -->
    <div class="facility-modal" id="facilityModal">
        <div class="facility-modal-content">
            <div class="facility-modal-header">
                <h2 class="facility-modal-title">
                    <i class="fas fa-building"></i> ËΩ¶Èó¥‰∏éËÆæÊñΩÂàóË°®
                </h2>
                <p class="facility-modal-subtitle">ÁÇπÂáª‰ªªÊÑèËΩ¶Èó¥ÊàñËÆæÊñΩÊü•Áúã‰∫åÁª¥Á†Å</p>
                <button class="facility-close-btn" id="facilityCloseBtn">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            
            <div class="facility-buttons-container">
                <div class="facility-buttons-grid" id="facilityButtonsGrid">
                    <!-- ËΩ¶Èó¥ËÆæÊñΩÊåâÈíÆÂ∞ÜÂú®ËøôÈáåÂä®ÊÄÅÁîüÊàê -->
                </div>
            </div>
        </div>
    </div>
    
    <!-- ‰∏ªÂÜÖÂÆπ - ‰∫åÁª¥Á†ÅÂ±ïÁ§∫È°µÈù¢ -->
    <div class="container" id="mainContainer">
        <div class="content">
            <div class="qr-display">
                <!-- ËøîÂõûÈÄâÊã©ÊåâÈíÆ - Áã¨Á´ã‰ΩçÁΩÆ -->
                <div class="back-to-facility-container">
                    <button class="back-to-facility-btn" id="backToFacilityBtn">
                        <i class="fas fa-arrow-left"></i> ËøîÂõûÈÄâÊã©
                    </button>
                </div>
                
                <h2><i class="fas fa-qrcode"></i> ÈóΩÊîøÈÄöÊ∂àÁÆ°ÂÆ∂‰∫åÁª¥Á†Å</h2>
                
                <div class="qr-code-wrapper">
                    <div class="qr-code-container" id="qrCodeContainer">
                        <!-- ËÆæÊñΩÁ†ÅÊ®°ÂºèÊèêÁ§∫ -->
                        
                        <div class="qr-placeholder">
                            <div id="qr-image" class="loading">
                                <div class="loading-spinner"></div>
                                <p>Âä†ËΩΩ‰∏≠...</p>
                            </div>
                        </div>
                        <div class="qr-info">
                            <div class="qr-title" id="qr-title">ËØ∑ÈÄâÊã©ËΩ¶Èó¥ÊàñËÆæÊñΩ</div>
                            <div class="qr-code" id="qr-code-text">B0000000000000</div>
                            <div class="qr-url-container">
                                <div class="qr-url-label">ËÆøÈóÆÈìæÊé•Ôºö</div>
                                <div class="qr-url" id="qr-url-text">https://zhxf.fj.119.gov.cn:8081/xgj/gzfw?qr=B0000000000000</div>
                            </div>
                            
                            <div class="action-buttons" id="action-buttons" style="display: none;">
                                <button class="action-btn next" id="next-btn">
                                    <i class="fas fa-arrow-right"></i> ‰∏ã‰∏Ä‰∏™ËÆæÊñΩÁ†Å
                                </button>
                            </div>
                            
                            <p class="instruction" id="instruction">‰ΩøÁî®ÊâãÊú∫Êâ´Êèè‰∫åÁª¥Á†ÅÊü•ÁúãËØ¶ÁªÜ‰ø°ÊÅØ</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <footer>
            <p>KingLong ËÆæÊñΩÁ†Å &copy; 2026</p>
        </footer>
    </div>
    
    <!-- ËΩ¶Èó¥‰∫åÁª¥Á†ÅÊâ´ÊèèÁ≥ªÁªüÈ°µÈù¢ - ‰øÆÊîπ‰∏∫‰ΩøÁî®index0.htmlÁöÑÊ†∑Âºè -->
    <div class="qr-scan-system" id="qrScanSystem">
        <!-- Â§¥ÈÉ® -->
        <header class="qr-scan-header">
            <div class="qr-scan-header-content">
                <div class="qr-scan-title-section">
                    <h1 class="qr-scan-main-title">ËΩ¶Èó¥‰∫åÁª¥Á†ÅÊâ´ÊèèÁ≥ªÁªü</h1>
                    <p class="qr-scan-subtitle">ÁÇπÂáªÂàÜÁ±ªÂ±ïÂºÄÊü•Áúã‰∫åÁª¥Á†Å</p>
                </div>
                <div class="qr-scan-controls-section">
                    <button class="control-btn collapse-all" id="collapseAllBtn">
                        <i class="fas fa-compress-alt"></i>
                        ÊäòÂè†ÊâÄÊúâÂàÜÁ±ª
                    </button>
                    <button class="control-btn back" id="backFromScanBtn">
                        <i class="fas fa-arrow-left"></i> ËøîÂõû
                    </button>
                </div>
            </div>
        </header>
        
        <!-- ‰∏ªÂÜÖÂÆπ -->
        <main class="qr-scan-main-content" id="categoryContainer">
            <!-- ÂÜÖÂÆπÂ∞ÜÈÄöËøáJavaScriptÂä®ÊÄÅÁîüÊàê -->
        </main>
        
        <!-- È°µËÑö -->
        <footer class="qr-scan-footer">
            <div class="qr-scan-footer-content">
                <p>KingLong ËΩ¶Èó¥‰∫åÁª¥Á†ÅÊâ´ÊèèÁ≥ªÁªü &copy; 2026</p>
            </div>
        </footer>
        <div class="toast" id="toast"></div>
    </div>

    <script>
        // È°µÈù¢Âä†ËΩΩÂä®ÁîªÊéßÂà∂
        const pageLoading = document.getElementById('page-loading');
        const loadingProgressBar = document.getElementById('loading-progress-bar');
        
        // Ê®°ÊãüÂä†ËΩΩËøõÂ∫¶
        function simulateLoadingProgress() {
            let progress = 0;
            const interval = setInterval(() => {
                progress += Math.random() * 10;
                if (progress > 100) {
                    progress = 100;
                    clearInterval(interval);
                }
                loadingProgressBar.style.width = progress + '%';
            }, 150);
            
            return interval;
        }
        
        // È°µÈù¢Âä†ËΩΩÂÆåÊàêÂ§ÑÁêÜ
        function handlePageLoaded() {
            clearInterval(progressInterval);
            loadingProgressBar.style.width = '100%';
            
            // Áü≠ÊöÇÂª∂ËøüÂêéÈöêËóèÂä†ËΩΩÂä®ÁîªÔºåÊòæÁ§∫Ê¨¢ËøéÂºπÁ™ó
            setTimeout(() => {
                pageLoading.classList.add('hidden');
                // Á°Æ‰øùÊ¨¢ËøéÂºπÁ™óÊòæÁ§∫
                const welcomeModal = document.getElementById('welcomeModal');
                welcomeModal.classList.remove('hidden');
                console.log('È°µÈù¢Âä†ËΩΩÂÆåÊàêÔºåÊòæÁ§∫Ê¨¢ËøéÂºπÁ™ó');
            }, 500);
        }
        
        // ÂºÄÂßãÊ®°ÊãüÂä†ËΩΩËøõÂ∫¶
        const progressInterval = simulateLoadingProgress();
        
        // Ëé∑ÂèñÂºπÁ™óÁõ∏ÂÖ≥DOMÂÖÉÁ¥†
        const welcomeModal = document.getElementById('welcomeModal');
        const clockModal = document.getElementById('clockModal');
        const facilityModal = document.getElementById('facilityModal');
        const mainContainer = document.getElementById('mainContainer');
        const qrScanSystem = document.getElementById('qrScanSystem');
        const startInspectionBtn = document.getElementById('startInspectionBtn');
        const clockInOutBtn = document.getElementById('clockInOutBtn');
        const closeClockModalBtn = document.getElementById('closeClockModalBtn');
        const facilityCloseBtn = document.getElementById('facilityCloseBtn');
        const facilityButtonsGrid = document.getElementById('facilityButtonsGrid');
        const backToFacilityBtn = document.getElementById('backToFacilityBtn');
        const clockQrPlaceholder = document.getElementById('clockQrPlaceholder');
        const clockCodeText = document.getElementById('clockCodeText');
        const clockUrlText = document.getElementById('clockUrlText');
        
        // Ëé∑Âèñ‰∫åÁª¥Á†ÅÂ±ïÁ§∫È°µÈù¢DOMÂÖÉÁ¥†
        const qrCodeContainer = document.getElementById('qrCodeContainer');
        const qrTitle = document.getElementById('qr-title');
        const qrCodeText = document.getElementById('qr-code-text');
        const qrUrlText = document.getElementById('qr-url-text');
        const qrImage = document.getElementById('qr-image');
        const actionButtons = document.getElementById('action-buttons');
        const nextBtn = document.getElementById('next-btn');
        const instruction = document.getElementById('instruction');
        
        // ËΩ¶Èó¥‰∫åÁª¥Á†ÅÊâ´ÊèèÁ≥ªÁªüÈ°µÈù¢ÂÖÉÁ¥†
        const collapseAllBtn = document.getElementById('collapseAllBtn');
        const backFromScanBtn = document.getElementById('backFromScanBtn');
        const categoryContainer = document.getElementById('categoryContainer');
        const toast = document.getElementById('toast');
        
        // ÊâìÂç°QRÁ†Å‰ø°ÊÅØ
        const CLOCK_QR_CODE = "S0000007287810";
        const CLOCK_QR_URL = "https://zhxf.fj.119.gov.cn:8081/xgj/gzfw?qr=S0000007287810";
        
        // Âü∫Á°ÄQRÁ†ÅURL
        const BASE_QR_URL = "https://zhxf.fj.119.gov.cn:8081/xgj/gzfw?qr=";
        
        // ËΩ¶Èó¥‰∏éËÆæÊñΩÊï∞ÊçÆ
        const facilities = [
            { name: "ÊÄªË£ÖËΩ¶Èó¥", code: "B0000006340822", type: "ËΩ¶Èó¥" },
            { name: "ÁÑäË£ÖËΩ¶Èó¥", code: "B0000006340824", type: "ËΩ¶Èó¥" },
            { name: "ÁîµÊ≥≥ËΩ¶Èó¥", code: "B0000006340826", type: "ËΩ¶Èó¥" },
            { name: "Ê∂ÇË£ÖËΩ¶Èó¥", code: "B0000006340830", type: "ËΩ¶Èó¥" },
            { name: "ÁâπÁßçÊ∂ÇË£ÖËΩ¶Èó¥", code: "B0000006340835", type: "ËΩ¶Èó¥" },
            { name: "ËØïÂà∂ËΩ¶Èó¥", code: "B0000006340839", type: "ËΩ¶Èó¥" },
            { name: "Ê∏ÖÊ¥ÅÊ•º", code: "B0000006340868", type: "ËÆæÊñΩ" },
            { name: "ÂÖÖÁîµÊ°©", code: "B0000006340870", type: "ËÆæÊñΩ" },
            { name: "ËÅîÂêàÂä®ÂäõÁ´ôÊàø", code: "B0000006343282", type: "ËÆæÊñΩ" },
            { name: "Ê±°Ê∞¥Â§ÑÁêÜÁ´ô", code: "B0000006343285", type: "ËÆæÊñΩ" },
            { name: "ÂÆ¢Êà∑ÊúçÂä°‰∏≠ÂøÉ", code: "B0000006343279", type: "ÂäûÂÖ¨Ê•º" },
            { name: "AÊ†ãÂäûÂÖ¨Ê•º", code: "B0000006340896", type: "ÂäûÂÖ¨Ê•º" },
            { name: "BÊ†ãÂäûÂÖ¨Ê•º", code: "B0000006340900", type: "ÂäûÂÖ¨Ê•º" },
            { name: "EÊ†ãÂäûÂÖ¨Ê•º", code: "B0000006341172", type: "ÂäûÂÖ¨Ê•º" }
        ];
        
        // ËÆæÊñΩÁ†ÅÊï∞ÊçÆ
        const facilityCodes = {
            "AÊ†ãÂäûÂÖ¨Ê•º": [
                { name: "ÁÅ≠ÁÅ´Âô®", code: "S0000009736239", url: "https://zhxf.fj.119.gov.cn:8081/xgj/gzfw?qr=S0000009736239" },
                { name: "ÁñèÊï£ÊåáÁ§∫", code: "S0000009735960", url: "https://zhxf.fj.119.gov.cn:8081/xgj/gzfw?qr=S0000009735960" },
                { name: "ÁñèÊï£Ê•ºÊ¢Ø", code: "S0000009735961", url: "https://zhxf.fj.119.gov.cn:8081/xgj/gzfw?qr=S0000009735961" },
                { name: "Â∫îÊÄ•ÁÖßÊòé", code: "S0000009735962", url: "https://zhxf.fj.119.gov.cn:8081/xgj/gzfw?qr=S0000009735962" }
            ],
            "BÊ†ãÂäûÂÖ¨Ê•º": [
                { name: "ÁÅ≠ÁÅ´Âô®", code: "S0000009736238", url: "https://zhxf.fj.119.gov.cn:8081/xgj/gzfw?qr=S0000009736238" },
                { name: "ÁñèÊï£ÊåáÁ§∫", code: "S0000009735968", url: "https://zhxf.fj.119.gov.cn:8081/xgj/gzfw?qr=S0000009735968" },
                { name: "ÁñèÊï£Ê•ºÊ¢Ø", code: "S0000009735965", url: "https://zhxf.fj.119.gov.cn:8081/xgj/gzfw?qr=S0000009735965" },
                { name: "Â∫îÊÄ•ÁÖßÊòé", code: "S0000009735969", url: "https://zhxf.fj.119.gov.cn:8081/xgj/gzfw?qr=S0000009735969" }
            ],
            "EÊ†ãÂäûÂÖ¨Ê•º": [
                { name: "ÁÅ≠ÁÅ´Âô®", code: "S0000009736236", url: "https://zhxf.fj.119.gov.cn:8081/xgj/gzfw?qr=S0000009736236" },
                { name: "ÁñèÊï£ÊåáÁ§∫", code: "S0000009736139", url: "https://zhxf.fj.119.gov.cn:8081/xgj/gzfw?qr=S0000009736139" },
                { name: "ÁñèÊï£Ê•ºÊ¢Ø", code: "S0000009736137", url: "https://zhxf.fj.119.gov.cn:8081/xgj/gzfw?qr=S0000009736137" },
                { name: "Â∫îÊÄ•ÁÖßÊòé", code: "S0000009736140", url: "https://zhxf.fj.119.gov.cn:8081/xgj/gzfw?qr=S0000009736140" }
            ],
            "ÂÆ¢Êà∑ÊúçÂä°‰∏≠ÂøÉ": [
                { name: "ÁÅ≠ÁÅ´Âô®", code: "S0000009736231", url: "https://zhxf.fj.119.gov.cn:8081/xgj/gzfw?qr=S0000009736231" },
                { name: "ÁñèÊï£ÊåáÁ§∫", code: "S0000009736269", url: "https://zhxf.fj.119.gov.cn:8081/xgj/gzfw?qr=S0000009736269" },
                { name: "ÁñèÊï£Ê•ºÊ¢Ø", code: "S0000009736194", url: "https://zhxf.fj.119.gov.cn:8081/xgj/gzfw?qr=S0000009736194" },
                { name: "Â∫îÊÄ•ÁÖßÊòé", code: "S0000009736157", url: "https://zhxf.fj.119.gov.cn:8081/xgj/gzfw?qr=S0000009736157" }
            ],
            "ÊÄªË£ÖËΩ¶Èó¥": [
                { name: "ÁÅ≠ÁÅ´Âô®", code: "S0000009736223", url: "https://zhxf.fj.119.gov.cn:8081/xgj/gzfw?qr=S0000009736223" },
                { name: "ÂÆâÂÖ®Âá∫Âè£", code: "S0000009735858", url: "https://zhxf.fj.119.gov.cn:8081/xgj/gzfw?qr=S0000009735858" },
                { name: "ÁñèÊï£ÊåáÁ§∫", code: "S0000009735859", url: "https://zhxf.fj.119.gov.cn:8081/xgj/gzfw?qr=S0000009735859" },
                { name: "ÈÖçÁîµÁÆ±", code: "S0000009735915", url: "https://zhxf.fj.119.gov.cn:8081/xgj/gzfw?qr=S0000009735915" }
            ],
            "ÁîµÊ≥≥ËΩ¶Èó¥": [
                { name: "ÁÅ≠ÁÅ´Âô®", code: "S0000009736225", url: "https://zhxf.fj.119.gov.cn:8081/xgj/gzfw?qr=S0000009736225" },
                { name: "Ê∂àÁÅ´Ê†ì", code: "S0000009735921", url: "https://zhxf.fj.119.gov.cn:8081/xgj/gzfw?qr=S0000009735921" },
                { name: "ÁñèÊï£ÈÄöÈÅì", code: "S0000009735920", url: "https://zhxf.fj.119.gov.cn:8081/xgj/gzfw?qr=S0000009735920" },
                { name: "Â∫îÊÄ•ÁÖßÊòé", code: "S0000009735918", url: "https://zhxf.fj.119.gov.cn:8081/xgj/gzfw?qr=S0000009735918" }
            ],
            "ÁÑäË£ÖËΩ¶Èó¥": [
                { name: "ÁÅ≠ÁÅ´Âô®", code: "S0000009736224", url: "https://zhxf.fj.119.gov.cn:8081/xgj/gzfw?qr=S0000009736224" },
                { name: "ÂÆâÂÖ®Âá∫Âè£", code: "S0000009736273", url: "https://zhxf.fj.119.gov.cn:8081/xgj/gzfw?qr=S0000009736273" },
                { name: "ÁñèÊï£ÈÄöÈÅì", code: "S0000009735923", url: "https://zhxf.fj.119.gov.cn:8081/xgj/gzfw?qr=S0000009735923" }
            ],
            "Ê∂ÇË£ÖËΩ¶Èó¥": [
                { name: "ÁÅ≠ÁÅ´Âô®", code: "S0000009736226", url: "https://zhxf.fj.119.gov.cn:8081/xgj/gzfw?qr=S0000009736226" },
                { name: "ÂÆâÂÖ®Âá∫Âè£", code: "S0000009735957", url: "https://zhxf.fj.119.gov.cn:8081/xgj/gzfw?qr=S0000009735957" },
                { name: "ÂæÆÂûãÊ∂àÈò≤Á´ô", code: "S0000009735956", url: "https://zhxf.fj.119.gov.cn:8081/xgj/gzfw?qr=S0000009735956" },
                { name: "Ê∂àÈò≤ÊéßÂà∂ÂÆ§", code: "S0000009735954", url: "https://zhxf.fj.119.gov.cn:8081/xgj/gzfw?qr=S0000009735954" }
            ],
            "Ê±°Ê∞¥Â§ÑÁêÜÁ´ô": [
                { name: "ÁÅ≠ÁÅ´Âô®", code: "S0000009736227", url: "https://zhxf.fj.119.gov.cn:8081/xgj/gzfw?qr=S0000009736227" },
                { name: "ÁñèÊï£Ê•ºÊ¢Ø", code: "S0000009736159", url: "https://zhxf.fj.119.gov.cn:8081/xgj/gzfw?qr=S0000009736159" }
            ],
            "ËØïÂà∂ËΩ¶Èó¥": [
                { name: "ÁÅ≠ÁÅ´Âô®", code: "S0000009736230", url: "https://zhxf.fj.119.gov.cn:8081/xgj/gzfw?qr=S0000009736230" },
                { name: "ÂÆâÂÖ®Âá∫Âè£", code: "S0000009735935", url: "https://zhxf.fj.119.gov.cn:8081/xgj/gzfw?qr=S0000009735935" }
            ],
            "ÁâπÁßçÊ∂ÇË£ÖËΩ¶Èó¥": [
                { name: "ÁÅ≠ÁÅ´Âô®", code: "S0000009736228", url: "https://zhxf.fj.119.gov.cn:8081/xgj/gzfw?qr=S0000009736228" },
                { name: "ÁñèÊï£ÊåáÁ§∫", code: "S0000009736119", url: "https://zhxf.fj.119.gov.cn:8081/xgj/gzfw?qr=S0000009736119" }
            ],
            "ÂÖÖÁîµÊ°©": [
                { name: "ÁÅ≠ÁÅ´Âô®", code: "S0000009736152", url: "https://zhxf.fj.119.gov.cn:8081/xgj/gzfw?qr=S0000009736152" },
                { name: "Ê∂àÁÅ´Ê†ì", code: "S0000009736151", url: "https://zhxf.fj.119.gov.cn:8081/xgj/gzfw?qr=S0000009736151" }
            ],
            "Ê∏ÖÊ¥ÅÊ•º": [
                { name: "ÁÅ≠ÁÅ´Âô®", code: "S0000009736240", url: "https://zhxf.fj.119.gov.cn:8081/xgj/gzfw?qr=S0000009736240" },
                { name: "ÈÖçÁîµÁÆ±", code: "S0000009735942", url: "https://zhxf.fj.119.gov.cn:8081/xgj/gzfw?qr=S0000009735942" }
            ],
            "ËÅîÂêàÂä®ÂäõÁ´ôÊàø": [
                { name: "ÁÅ≠ÁÅ´Âô®", code: "S0000009736229", url: "https://zhxf.fj.119.gov.cn:8081/xgj/gzfw?qr=S0000009736229" },
                { name: "ÈÖçÁîµÁÆ±", code: "S0000009736168", url: "https://zhxf.fj.119.gov.cn:8081/xgj/gzfw?qr=S0000009736168" }
            ]
        };
        
        // ËΩ¶Èó¥‰∫åÁª¥Á†ÅÊâ´ÊèèÁ≥ªÁªüÊï∞ÊçÆ
        const qrScanData = [
            {
                category: "Áîü‰∫ßËΩ¶Èó¥",
                icon: "fas fa-industry",
                items: [
                    {
                        subCategory: "ÊÄªË£ÖËΩ¶Èó¥",
                        subCategoryIcon: "fas fa-cogs",
                        items: [
                            { name: "ÊÄªË£ÖËΩ¶Èó¥", code: "B0000006340822", url: "https://zhxf.fj.119.gov.cn:8081/xgj/gzfw?qr=B0000006340822" },
                            { name: "ÊÄªË£ÖËΩ¶Èó¥-Âú∞‰∏ä1Â±Ç", code: "B0000006340823", url: "https://zhxf.fj.119.gov.cn:8081/xgj/gzfw?qr=B0000006340823" }
                        ]
                    },
                    {
                        subCategory: "ÁÑäË£ÖËΩ¶Èó¥",
                        subCategoryIcon: "fas fa-wrench",
                        items: [
                            { name: "ÁÑäË£ÖËΩ¶Èó¥", code: "B0000006340824", url: "https://zhxf.fj.119.gov.cn:8081/xgj/gzfw?qr=B0000006340824" },
                            { name: "ÁÑäË£ÖËΩ¶Èó¥-Âú∞‰∏ä1Â±Ç", code: "B0000006340825", url: "https://zhxf.fj.119.gov.cn:8081/xgj/gzfw?qr=B0000006340825" }
                        ]
                    },
                    {
                        subCategory: "ÁîµÊ≥≥ËΩ¶Èó¥",
                        subCategoryIcon: "fas fa-tint",
                        items: [
                            { name: "ÁîµÊ≥≥ËΩ¶Èó¥", code: "B0000006340826", url: "https://zhxf.fj.119.gov.cn:8081/xgj/gzfw?qr=B0000006340826" },
                            { name: "ÁîµÊ≥≥ËΩ¶Èó¥-Âú∞‰∏ä1Â±Ç", code: "B0000006340827", url: "https://zhxf.fj.119.gov.cn:8081/xgj/gzfw?qr=B0000006340827" },
                            { name: "ÁîµÊ≥≥ËΩ¶Èó¥-Âú∞‰∏ä2Â±Ç", code: "B0000006340828", url: "https://zhxf.fj.119.gov.cn:8081/xgj/gzfw?qr=B0000006340828" },
                            { name: "ÁîµÊ≥≥ËΩ¶Èó¥-Âú∞‰∏ä3Â±Ç", code: "B0000006340829", url: "https://zhxf.fj.119.gov.cn:8081/xgj/gzfw?qr=B0000006340829" }
                        ]
                    },
                    {
                        subCategory: "Ê∂ÇË£ÖËΩ¶Èó¥",
                        subCategoryIcon: "fas fa-paint-roller",
                        items: [
                            { name: "Ê∂ÇË£ÖËΩ¶Èó¥", code: "B0000006340830", url: "https://zhxf.fj.119.gov.cn:8081/xgj/gzfw?qr=B0000006340830" },
                            { name: "Ê∂ÇË£ÖËΩ¶Èó¥-Âú∞‰∏ä1Â±Ç", code: "B0000006340831", url: "https://zhxf.fj.119.gov.cn:8081/xgj/gzfw?qr=B0000006340831" },
                            { name: "Ê∂ÇË£ÖËΩ¶Èó¥-Âú∞‰∏ä2Â±Ç", code: "B0000006340832", url: "https://zhxf.fj.119.gov.cn:8081/xgj/gzfw?qr=B0000006340832" },
                            { name: "Ê∂ÇË£ÖËΩ¶Èó¥-Âú∞‰∏ä3Â±Ç", code: "B0000006340833", url: "https://zhxf.fj.119.gov.cn:8081/xgj/gzfw?qr=B0000006340833" }
                        ]
                    },
                    {
                        subCategory: "ÁâπÁßçÊ∂ÇË£ÖËΩ¶Èó¥",
                        subCategoryIcon: "fas fa-spray-can",
                        items: [
                            { name: "ÁâπÁßçÊ∂ÇË£ÖËΩ¶Èó¥", code: "B0000006340835", url: "https://zhxf.fj.119.gov.cn:8081/xgj/gzfw?qr=B0000006340835" },
                            { name: "ÁâπÁßçÊ∂ÇË£ÖËΩ¶Èó¥-Âú∞‰∏ä1Â±Ç", code: "B0000006340836", url: "https://zhxf.fj.119.gov.cn:8081/xgj/gzfw?qr=B0000006340836" }
                        ]
                    },
                    {
                        subCategory: "ËØïÂà∂ËΩ¶Èó¥",
                        subCategoryIcon: "fas fa-flask",
                        items: [
                            { name: "ËØïÂà∂ËΩ¶Èó¥", code: "B0000006340839", url: "https://zhxf.fj.119.gov.cn:8081/xgj/gzfw?qr=B0000006340839" },
                            { name: "ËØïÂà∂ËΩ¶Èó¥-Âú∞‰∏ä1Â±Ç", code: "B0000006340840", url: "https://zhxf.fj.119.gov.cn:8081/xgj/gzfw?qr=B0000006340840" }
                        ]
                    },
                    {
                        subCategory: "Âà∂‰ª∂ËΩ¶Èó¥",
                        subCategoryIcon: "fas fa-cut",
                        items: [
                            { name: "Âà∂‰ª∂ËΩ¶Èó¥", code: "B0000006340841", url: "https://zhxf.fj.119.gov.cn:8081/xgj/gzfw?qr=B0000006340841" },
                            { name: "Âà∂‰ª∂ËΩ¶Èó¥-Âú∞‰∏ä1Â±Ç", code: "B0000006340842", url: "https://zhxf.fj.119.gov.cn:8081/xgj/gzfw?qr=B0000006340842" }
                        ]
                    }
                ]
            },
            {
                category: "ÂäûÂÖ¨Ê•º",
                icon: "fas fa-building",
                items: [
                    {
                        subCategory: "AÊ†ãÂäûÂÖ¨Ê•º",
                        subCategoryIcon: "fas fa-building",
                        items: [
                            { name: "AÊ†ãÂäûÂÖ¨Ê•º", code: "B0000006340896", url: "https://zhxf.fj.119.gov.cn:8081/xgj/gzfw?qr=B0000006340896" },
                            { name: "AÊ†ãÂäûÂÖ¨Ê•º-Âú∞‰∏ä1Â±Ç", code: "B0000006340897", url: "https://zhxf.fj.119.gov.cn:8081/xgj/gzfw?qr=B0000006340897" },
                            { name: "AÊ†ãÂäûÂÖ¨Ê•º-Âú∞‰∏ä2Â±Ç", code: "B0000006340898", url: "https://zhxf.fj.119.gov.cn:8081/xgj/gzfw?qr=B0000006340898" },
                            { name: "AÊ†ãÂäûÂÖ¨Ê•º-Âú∞‰∏ä3Â±Ç", code: "B0000006340899", url: "https://zhxf.fj.119.gov.cn:8081/xgj/gzfw?qr=B0000006340899" }
                        ]
                    },
                    {
                        subCategory: "BÊ†ãÂäûÂÖ¨Ê•º",
                        subCategoryIcon: "fas fa-building",
                        items: [
                            { name: "BÊ†ãÂäûÂÖ¨Ê•º", code: "B0000006340900", url: "https://zhxf.fj.119.gov.cn:8081/xgj/gzfw?qr=B0000006340900" },
                            { name: "BÊ†ãÂäûÂÖ¨Ê•º-Âú∞‰∏ä1Â±Ç", code: "B0000006340901", url: "https://zhxf.fj.119.gov.cn:8081/xgj/gzfw?qr=B0000006340901" },
                            { name: "BÊ†ãÂäûÂÖ¨Ê•º-Âú∞‰∏ä2Â±Ç", code: "B0000006340902", url: "https://zhxf.fj.119.gov.cn:8081/xgj/gzfw?qr=B0000006340902" },
                            { name: "BÊ†ãÂäûÂÖ¨Ê•º-Âú∞‰∏ä3Â±Ç", code: "B0000006340903", url: "https://zhxf.fj.119.gov.cn:8081/xgj/gzfw?qr=B0000006340903" }
                        ]
                    },
                    {
                        subCategory: "CÊ†ãÂäûÂÖ¨Ê•º",
                        subCategoryIcon: "fas fa-building",
                        items: [
                            { name: "CÊ†ãÂäûÂÖ¨Ê•º", code: "B0000006341007", url: "https://zhxf.fj.119.gov.cn:8081/xgj/gzfw?qr=B0000006341007" },
                            { name: "CÊ†ãÂäûÂÖ¨Ê•º-Âú∞‰∏ä1Â±Ç", code: "B0000006341008", url: "https://zhxf.fj.119.gov.cn:8081/xgj/gzfw?qr=B0000006341008" },
                            { name: "CÊ†ãÂäûÂÖ¨Ê•º-Âú∞‰∏ä2Â±Ç", code: "B0000006341009", url: "https://zhxf.fj.119.gov.cn:8081/xgj/gzfw?qr=B0000006341009" }
                        ]
                    },
                    {
                        subCategory: "EÊ†ãÂäûÂÖ¨Ê•º",
                        subCategoryIcon: "fas fa-building",
                        items: [
                            { name: "EÊ†ãÂäûÂÖ¨Ê•º", code: "B0000006341172", url: "https://zhxf.fj.119.gov.cn:8081/xgj/gzfw?qr=B0000006341172" },
                            { name: "EÊ†ãÂäûÂÖ¨Ê•º-Âú∞‰∏ä1Â±Ç", code: "B0000006341173", url: "https://zhxf.fj.119.gov.cn:8081/xgj/gzfw?qr=B0000006341173" },
                            { name: "EÊ†ãÂäûÂÖ¨Ê•º-Âú∞‰∏ä2Â±Ç", code: "B0000006341174", url: "https://zhxf.fj.119.gov.cn:8081/xgj/gzfw?qr=B0000006341174" },
                            { name: "EÊ†ãÂäûÂÖ¨Ê•º-Âú∞‰∏ä3Â±Ç", code: "B0000006341175", url: "https://zhxf.fj.119.gov.cn:8081/xgj/gzfw?qr=B0000006341175" },
                            { name: "EÊ†ãÂäûÂÖ¨Ê•º-Âú∞‰∏ä4Â±Ç", code: "B0000006341176", url: "https://zhxf.fj.119.gov.cn:8081/xgj/gzfw?qr=B0000006341176" },
                            { name: "EÊ†ãÂäûÂÖ¨Ê•º-Âú∞‰∏ä5Â±Ç", code: "B0000006341177", url: "https://zhxf.fj.119.gov.cn:8081/xgj/gzfw?qr=B0000006341177" },
                            { name: "EÊ†ãÂäûÂÖ¨Ê•º-Âú∞‰∏ä6Â±Ç", code: "B0000006341178", url: "https://zhxf.fj.119.gov.cn:8081/xgj/gzfw?qr=B0000006341178" },
                            { name: "EÊ†ãÂäûÂÖ¨Ê•º-Âú∞‰∏ã1Â±Ç", code: "B0000006341179", url: "https://zhxf.fj.119.gov.cn:8081/xgj/gzfw?qr=B0000006341179" }
                        ]
                    }
                ]
            },
            {
                category: "ËÆæÊñΩ‰∏éÁ´ôÊàø",
                icon: "fas fa-tools",
                items: [
                    {
                        subCategory: "Ê∏ÖÊ¥ÅÊ•º",
                        subCategoryIcon: "fas fa-broom",
                        items: [
                            { name: "Ê∏ÖÊ¥ÅÊ•º", code: "B0000006340868", url: "https://zhxf.fj.119.gov.cn:8081/xgj/gzfw?qr=B0000006340868" },
                            { name: "Ê∏ÖÊ¥ÅÊ•º-Âú∞‰∏ä1Â±Ç", code: "B0000006340869", url: "https://zhxf.fj.119.gov.cn:8081/xgj/gzfw?qr=B0000006340869" }
                        ]
                    },
                    {
                        subCategory: "ÂÖÖÁîµÊ°©",
                        subCategoryIcon: "fas fa-charging-station",
                        items: [
                            { name: "ÂÖÖÁîµÊ°©", code: "B0000006340870", url: "https://zhxf.fj.119.gov.cn:8081/xgj/gzfw?qr=B0000006340870" },
                            { name: "ÂÖÖÁîµÊ°©-Âú∞‰∏ä1Â±Ç", code: "B0000006340871", url: "https://zhxf.fj.119.gov.cn:8081/xgj/gzfw?qr=B0000006340871" }
                        ]
                    },
                    {
                        subCategory: "ËÅîÂêàÂä®ÂäõÁ´ôÊàø",
                        subCategoryIcon: "fas fa-bolt",
                        items: [
                            { name: "ËÅîÂêàÂä®ÂäõÁ´ôÊàø", code: "B0000006343282", url: "https://zhxf.fj.119.gov.cn:8081/xgj/gzfw?qr=B0000006343282" },
                            { name: "ËÅîÂêàÂä®ÂäõÁ´ôÊàø-Âú∞‰∏ä1Â±Ç", code: "B0000006343283", url: "https://zhxf.fj.119.gov.cn:8081/xgj/gzfw?qr=B0000006343283" }
                        ]
                    },
                    {
                        subCategory: "Ê±°Ê∞¥Â§ÑÁêÜÁ´ô",
                        subCategoryIcon: "fas fa-water",
                        items: [
                            { name: "Ê±°Ê∞¥Â§ÑÁêÜÁ´ô", code: "B0000006343285", url: "https://zhxf.fj.119.gov.cn:8081/xgj/gzfw?qr=B0000006343285" },
                            { name: "Ê±°Ê∞¥Â§ÑÁêÜÁ´ô-Âú∞‰∏ä1Â±Ç", code: "B0000006343286", url: "https://zhxf.fj.119.gov.cn:8081/xgj/gzfw?qr=B0000006343286" }
                        ]
                    }
                ]
            },
            {
                category: "ÊúçÂä°‰∏≠ÂøÉ",
                icon: "fas fa-concierge-bell",
                items: [
                    {
                        subCategory: "ÂÆûÈ™å‰∏≠ÂøÉ",
                        subCategoryIcon: "fas fa-microscope",
                        items: [
                            { name: "ÂÆûÈ™å‰∏≠ÂøÉ", code: "B0000006341241", url: "https://zhxf.fj.119.gov.cn:8081/xgj/gzfw?qr=B0000006341241" },
                            { name: "ÂÆûÈ™å‰∏≠ÂøÉ-Âú∞‰∏ä1Â±Ç", code: "B0000006341242", url: "https://zhxf.fj.119.gov.cn:8081/xgj/gzfw?qr=B0000006341242" },
                            { name: "ÂÆûÈ™å‰∏≠ÂøÉ-Âú∞‰∏ä2Â±Ç", code: "B0000006341311", url: "https://zhxf.fj.119.gov.cn:8081/xgj/gzfw?qr=B0000006341311" },
                            { name: "ÂÆûÈ™å‰∏≠ÂøÉ-Âú∞‰∏ä3Â±Ç", code: "B0000006341312", url: "https://zhxf.fj.119.gov.cn:8081/xgj/gzfw?qr=B0000006341312" }
                        ]
                    },
                    {
                        subCategory: "ÂÆ¢Êà∑ÊúçÂä°‰∏≠ÂøÉ",
                        subCategoryIcon: "fas fa-headset",
                        items: [
                            { name: "ÂÆ¢Êà∑ÊúçÂä°‰∏≠ÂøÉ", code: "B0000006343279", url: "https://zhxf.fj.119.gov.cn:8081/xgj/gzfw?qr=B0000006343279" },
                            { name: "ÂÆ¢Êà∑ÊúçÂä°‰∏≠ÂøÉ-Âú∞‰∏ä1Â±Ç", code: "B0000006343280", url: "https://zhxf.fj.119.gov.cn:8081/xgj/gzfw?qr=B0000006343280" },
                            { name: "ÂÆ¢Êà∑ÊúçÂä°‰∏≠ÂøÉ-Âú∞‰∏ä2Â±Ç", code: "B0000006343281", url: "https://zhxf.fj.119.gov.cn:8081/xgj/gzfw?qr=B0000006343281" }
                        ]
                    }
                ]
            }
        ];
        
        // ÂΩìÂâçÁä∂ÊÄÅÂèòÈáè
        let selectedFacility = null;
        let currentFacilityCodes = [];
        let currentFacilityIndex = -1;
        let isFacilityMode = false;
        let currentBuildingName = '';
        
        // È°µÈù¢Âä†ËΩΩÊó∂ÂàùÂßãÂåñ
        document.addEventListener('DOMContentLoaded', function() {
            console.log('È°µÈù¢DOMÂä†ËΩΩÂÆåÊàê');
            
            // Âª∂ËøüÊâßË°å‰ª•Á°Æ‰øùÊâÄÊúâËµÑÊ∫êÂä†ËΩΩ
            setTimeout(() => {
                handlePageLoaded();
                
                // ÂàùÂßãÂåñËΩ¶Èó¥ÈÄâÊã©ÂºπÁ™óÊåâÈíÆ
                initializeFacilityButtons();
                
                // ÂàùÂßãÂåñËΩ¶Èó¥‰∫åÁª¥Á†ÅÊâ´ÊèèÁ≥ªÁªü
                initializeQRScanSystem();
                
                // ÁªëÂÆö‰∫ã‰ª∂ÁõëÂê¨Âô®
                bindEventListeners();
            }, 300);
        });
        
        // ÂàùÂßãÂåñËΩ¶Èó¥ÈÄâÊã©ÂºπÁ™óÊåâÈíÆ
        function initializeFacilityButtons() {
            console.log('ÂàùÂßãÂåñËΩ¶Èó¥ÊåâÈíÆ');
            
            // ÂÖàÊ∑ªÂä†ÂéüÊúâÁöÑËΩ¶Èó¥ÊåâÈíÆ
            facilities.forEach(facility => {
                const button = document.createElement('button');
                button.className = 'facility-btn';
                button.dataset.code = facility.code;
                button.dataset.name = facility.name;
                button.dataset.type = facility.type;
                
                // ÂàõÂª∫ÊåâÈíÆÂÜÖÂÆπ
                const nameSpan = document.createElement('span');
                nameSpan.textContent = facility.name;
                
                const typeSpan = document.createElement('span');
                typeSpan.className = 'type-tag';
                typeSpan.textContent = facility.type;
                
                button.appendChild(nameSpan);
                button.appendChild(typeSpan);
                
                // ÁÇπÂáªÁõ¥Êé•ËøõÂÖ•‰∫åÁª¥Á†ÅÂ±ïÁ§∫È°µÈù¢
                button.addEventListener('click', function() {
                    console.log('ÁÇπÂáª‰∫ÜËΩ¶Èó¥ÊåâÈíÆ:', this.dataset.name);
                    // ËÆæÁΩÆÂΩìÂâçÈÄâÊã©ÁöÑËÆæÊñΩ
                    selectedFacility = {
                        name: this.dataset.name,
                        code: this.dataset.code,
                        type: this.dataset.type
                    };
                    
                    // ÂÖ≥Èó≠ËΩ¶Èó¥ÈÄâÊã©ÂºπÁ™óÔºåÊòæÁ§∫‰∏ªÂÜÖÂÆπÔºà‰∫åÁª¥Á†ÅÂ±ïÁ§∫È°µÈù¢Ôºâ
                    facilityModal.classList.remove('active');
                    mainContainer.classList.add('active');
                    
                    // ËÆæÁΩÆÂΩìÂâçÈÄâÊã©ÁöÑËÆæÊñΩ
                    currentBuildingName = selectedFacility.name;
                    currentFacilityCodes = facilityCodes[currentBuildingName] || [];
                    
                    // ÈáçÁΩÆËÆæÊñΩÊ®°Âºè
                    isFacilityMode = false;
                    qrCodeContainer.classList.remove('facility-mode-active');
                    actionButtons.style.display = 'none';
                    instruction.textContent = 'üëâüèª ÁÇπÂáªÂ±èÂπï‰∫åÁª¥Á†ÅÂàáÊç¢Âà∞ËÆæÊñΩÁ†Å';
                    
                    // Êõ¥Êñ∞‰∫åÁª¥Á†ÅÊòæÁ§∫
                    updateBuildingQRDisplay(selectedFacility.name, selectedFacility.code, selectedFacility.type);
                });
                
                facilityButtonsGrid.appendChild(button);
            });
            
            // Ê∑ªÂä†Ë∂ÖÁ∫≤ËÆæÊñΩÁ†ÅÊåâÈíÆÔºà‰ΩøÁî®‰∏éÂÖ∂‰ªñÊåâÈíÆÁõ∏ÂêåÁöÑÊ†∑ÂºèÔºâ
            const specialButton = document.createElement('button');
            specialButton.className = 'facility-btn';
            specialButton.id = 'superSteelFacilityBtn';
            
            // ÂàõÂª∫ÊåâÈíÆÂÜÖÂÆπ
            const nameSpan = document.createElement('span');
            nameSpan.textContent = 'Ë∂ÖÁ∫≤ËÆæÊñΩÁ†Å';
            
            const typeSpan = document.createElement('span');
            typeSpan.className = 'type-tag';
            typeSpan.textContent = 'Âú∞‰∏ä‰∏ÄÂ±Ç';
            
            specialButton.appendChild(nameSpan);
            specialButton.appendChild(typeSpan);
            
            // ÁÇπÂáªËøõÂÖ•ËΩ¶Èó¥‰∫åÁª¥Á†ÅÊâ´ÊèèÁ≥ªÁªü
            specialButton.addEventListener('click', function() {
                console.log('ÁÇπÂáª‰∫ÜË∂ÖÁ∫≤ËÆæÊñΩÁ†ÅÊåâÈíÆ');
                // ÂÖ≥Èó≠ËΩ¶Èó¥ÈÄâÊã©ÂºπÁ™óÔºåÊòæÁ§∫ËΩ¶Èó¥‰∫åÁª¥Á†ÅÊâ´ÊèèÁ≥ªÁªü
                facilityModal.classList.remove('active');
                qrScanSystem.classList.add('active');
            });
            
            facilityButtonsGrid.appendChild(specialButton);
        }
        
        // ÂàùÂßãÂåñËΩ¶Èó¥‰∫åÁª¥Á†ÅÊâ´ÊèèÁ≥ªÁªü - ‰ΩøÁî®Êñ∞ÁöÑUIÁªìÊûÑ
        function initializeQRScanSystem() {
            console.log('ÂàùÂßãÂåñËΩ¶Èó¥‰∫åÁª¥Á†ÅÊâ´ÊèèÁ≥ªÁªü');
            
            // Ê∏ÖÁ©∫ÂÆπÂô®
            categoryContainer.innerHTML = '';
            
            // ÈÅçÂéÜÊï∞ÊçÆÂàõÂª∫ÂàÜÁ±ª
            qrScanData.forEach((categoryData, categoryIndex) => {
                // ÂàõÂª∫ÂàÜÁ±ªÂÆπÂô®
                const categoryDiv = document.createElement('div');
                categoryDiv.className = 'category-collapse';
                
                // ËÆ°ÁÆóËØ•ÂàÜÁ±ª‰∏ãÁöÑÊÄªÈ°πÁõÆÊï∞
                let totalItems = 0;
                categoryData.items.forEach(subCategory => {
                    totalItems += subCategory.items.length;
                });
                
                // ÂàõÂª∫ÊäòÂè†ÊåâÈíÆ
                const collapseBtn = document.createElement('button');
                collapseBtn.className = 'collapse-btn collapsed';
                collapseBtn.dataset.target = `category-${categoryIndex}`;
                
                // ÂàõÂª∫ÂàÜÁ±ªÂ§¥ÈÉ®
                const categoryHeader = document.createElement('div');
                categoryHeader.className = 'category-header';
                
                const categoryIcon = document.createElement('div');
                categoryIcon.className = 'category-icon';
                categoryIcon.innerHTML = `<i class="${categoryData.icon}"></i>`;
                
                const categoryTitleDiv = document.createElement('div');
                const categoryTitle = document.createElement('h2');
                categoryTitle.className = 'category-title';
                categoryTitle.innerHTML = `${categoryData.category} <span class="category-count">${totalItems}‰∏™È°πÁõÆ</span>`;
                categoryTitleDiv.appendChild(categoryTitle);
                
                const collapseIndicator = document.createElement('i');
                collapseIndicator.className = 'fas fa-chevron-down collapse-indicator';
                
                categoryHeader.appendChild(categoryIcon);
                categoryHeader.appendChild(categoryTitleDiv);
                
                collapseBtn.appendChild(categoryHeader);
                collapseBtn.appendChild(collapseIndicator);
                
                // ÂàõÂª∫ÊäòÂè†ÂÜÖÂÆπÂå∫Âüü
                const collapseContent = document.createElement('div');
                collapseContent.className = 'collapse-content';
                collapseContent.id = `category-${categoryIndex}`;
                
                // ÈÅçÂéÜÂ≠êÂàÜÁ±ª
                categoryData.items.forEach((subCategoryData, subCategoryIndex) => {
                    // ÂàõÂª∫Â≠êÂàÜÁ±ª
                    const subcategoryDiv = document.createElement('div');
                    subcategoryDiv.className = 'subcategory';
                    
                    // ÂàõÂª∫Â≠êÂàÜÁ±ªÂ§¥ÈÉ®
                    const subcategoryHeader = document.createElement('div');
                    subcategoryHeader.className = 'subcategory-header';
                    
                    const subcategoryIcon = document.createElement('div');
                    subcategoryIcon.className = 'subcategory-icon';
                    subcategoryIcon.innerHTML = `<i class="${subCategoryData.subCategoryIcon}"></i>`;
                    
                    const subcategoryTitle = document.createElement('h3');
                    subcategoryTitle.className = 'subcategory-title';
                    subcategoryTitle.textContent = subCategoryData.subCategory;
                    
                    subcategoryHeader.appendChild(subcategoryIcon);
                    subcategoryHeader.appendChild(subcategoryTitle);
                    
                    // ÂàõÂª∫‰∫åÁª¥Á†ÅÁΩëÊ†º
                    const qrGrid = document.createElement('div');
                    qrGrid.className = 'qr-grid';
                    
                    // ÈÅçÂéÜÈ°πÁõÆ
                    subCategoryData.items.forEach((item, itemIndex) => {
                        const qrItem = document.createElement('div');
                        qrItem.className = 'qr-item';
                        
                        // ‰∫åÁª¥Á†ÅÂÆπÂô®
                        const qrCodeContainerNew = document.createElement('div');
                        qrCodeContainerNew.className = 'qr-code-container-new';
                        
                        // ‰∫åÁª¥Á†ÅÂõæÁâá
                        const qrCodeImg = document.createElement('img');
                        qrCodeImg.className = 'qr-code-img';
                        qrCodeImg.alt = `${item.name}‰∫åÁª¥Á†Å`;
                        qrCodeImg.src = `https://api.qrserver.com/v1/create-qr-code/?size=150x150&data=${encodeURIComponent(item.url)}`;
                        
                        // ÊÇ¨ÂÅúË¶ÜÁõñÂ±Ç
                        const qrOverlay = document.createElement('div');
                        qrOverlay.className = 'qr-overlay';
                        qrOverlay.innerHTML = '<i class="fas fa-expand-alt" style="font-size: 24px; color: white;"></i>';
                        
                        qrCodeContainerNew.appendChild(qrCodeImg);
                        qrCodeContainerNew.appendChild(qrOverlay);
                        
                        // ‰∫åÁª¥Á†Å‰ø°ÊÅØ
                        const qrInfoNew = document.createElement('div');
                        qrInfoNew.className = 'qr-info-new';
                        
                        const qrLabel = document.createElement('div');
                        qrLabel.className = 'qr-label';
                        qrLabel.textContent = item.name;
                        
                        const qrDesc = document.createElement('div');
                        qrDesc.className = 'qr-desc';
                        qrDesc.textContent = 'Êâ´Á†ÅËÆøÈóÆËØ¶ÁªÜ‰ø°ÊÅØ';
                        
                        qrInfoNew.appendChild(qrLabel);
                        qrInfoNew.appendChild(qrDesc);
                        
                        // ÁªÑË£ÖÈ°πÁõÆ
                        qrItem.appendChild(qrCodeContainerNew);
                        qrItem.appendChild(qrInfoNew);
                        
                        // Ê∑ªÂä†ÁÇπÂáª‰∫ã‰ª∂ - Â§çÂà∂ÈìæÊé•
                        qrItem.addEventListener('click', function(e) {
                            if (e.target.closest('.qr-code-container-new')) {
                                copyToClipboard(item.url);
                            }
                        });
                        
                        // Ê∑ªÂä†Âà∞ÁΩëÊ†º
                        qrGrid.appendChild(qrItem);
                    });
                    
                    // ÁªÑË£ÖÂ≠êÂàÜÁ±ª
                    subcategoryDiv.appendChild(subcategoryHeader);
                    subcategoryDiv.appendChild(qrGrid);
                    
                    // Ê∑ªÂä†Âà∞ÊäòÂè†ÂÜÖÂÆπ
                    collapseContent.appendChild(subcategoryDiv);
                });
                
                // Ê∑ªÂä†ÊäòÂè†ÊåâÈíÆÁÇπÂáª‰∫ã‰ª∂
                collapseBtn.addEventListener('click', function() {
                    const targetContent = document.getElementById(this.dataset.target);
                    const isCollapsed = this.classList.contains('collapsed');
                    
                    if (isCollapsed) {
                        this.classList.remove('collapsed');
                        targetContent.classList.add('expanded');
                    } else {
                        this.classList.add('collapsed');
                        targetContent.classList.remove('expanded');
                    }
                    
                    // Ëß¶ËßâÂèçÈ¶à
                    if ('vibrate' in navigator) {
                        navigator.vibrate(20);
                    }
                });
                
                // ÁªÑË£ÖÂàÜÁ±ª
                categoryDiv.appendChild(collapseBtn);
                categoryDiv.appendChild(collapseContent);
                categoryContainer.appendChild(categoryDiv);
            });
        }
        
        // ÁªëÂÆöÊâÄÊúâ‰∫ã‰ª∂ÁõëÂê¨Âô®
        function bindEventListeners() {
            console.log('ÁªëÂÆö‰∫ã‰ª∂ÁõëÂê¨Âô®');
            
            // "ÂºÄÂßãÂ∑°Êü•‰ªªÂä°"ÊåâÈíÆÁÇπÂáª‰∫ã‰ª∂
            startInspectionBtn.addEventListener('click', function() {
                console.log('ÁÇπÂáª‰∫ÜÂºÄÂßãÂ∑°Êü•‰ªªÂä°ÊåâÈíÆ');
                // ÈöêËóèÊ¨¢ËøéÂºπÁ™óÔºåÊòæÁ§∫ËΩ¶Èó¥ÈÄâÊã©ÂºπÁ™ó
                welcomeModal.classList.add('hidden');
                facilityModal.classList.add('active');
            });
            
            // "‰∏ä‰∏ãÁè≠ÊâìÂç°"ÊåâÈíÆÁÇπÂáª‰∫ã‰ª∂
            clockInOutBtn.addEventListener('click', function() {
                console.log('ÁÇπÂáª‰∫Ü‰∏ä‰∏ãÁè≠ÊâìÂç°ÊåâÈíÆ');
                // ÈöêËóèÊ¨¢ËøéÂºπÁ™óÔºåÊòæÁ§∫ÊâìÂç°ÂºπÁ™ó
                welcomeModal.classList.add('hidden');
                clockModal.classList.add('active');
                
                // ÁîüÊàêÊâìÂç°‰∫åÁª¥Á†Å
                generateClockQRCode();
            });
            
            // ÂÖ≥Èó≠ÊâìÂç°ÂºπÁ™óÊåâÈíÆÁÇπÂáª‰∫ã‰ª∂
            closeClockModalBtn.addEventListener('click', function() {
                console.log('ÁÇπÂáª‰∫ÜÂÖ≥Èó≠ÊâìÂç°ÂºπÁ™óÊåâÈíÆ');
                // ÂÖ≥Èó≠ÊâìÂç°ÂºπÁ™óÔºåÂõûÂà∞Ê¨¢ËøéÂºπÁ™ó
                clockModal.classList.remove('active');
                welcomeModal.classList.remove('hidden');
            });
            
            // ËΩ¶Èó¥ÈÄâÊã©ÂºπÁ™óÂÖ≥Èó≠ÊåâÈíÆÁÇπÂáª‰∫ã‰ª∂
            facilityCloseBtn.addEventListener('click', function() {
                console.log('ÁÇπÂáª‰∫ÜËΩ¶Èó¥ÂºπÁ™óÂÖ≥Èó≠ÊåâÈíÆ');
                // ÂÖ≥Èó≠ËΩ¶Èó¥ÈÄâÊã©ÂºπÁ™óÔºåÂõûÂà∞Ê¨¢ËøéÂºπÁ™ó
                facilityModal.classList.remove('active');
                welcomeModal.classList.remove('hidden');
            });
            
            // ‰∫åÁª¥Á†ÅÂ±ïÁ§∫È°µÈù¢ËøîÂõûÊåâÈíÆÁÇπÂáª‰∫ã‰ª∂
            backToFacilityBtn.addEventListener('click', function() {
                console.log('ÁÇπÂáª‰∫ÜËøîÂõûÈÄâÊã©ÊåâÈíÆ');
                // ÈöêËóè‰∏ªÂÜÖÂÆπÔºåÊòæÁ§∫ËΩ¶Èó¥ÈÄâÊã©ÂºπÁ™ó
                mainContainer.classList.remove('active');
                facilityModal.classList.add('active');
            });
            
            // ‰∫åÁª¥Á†ÅÂÆπÂô®ÁÇπÂáª‰∫ã‰ª∂ - ËøõÂÖ•ËÆæÊñΩÁ†ÅÊ®°Âºè
            qrCodeContainer.addEventListener('click', function() {
                console.log('ÁÇπÂáª‰∫Ü‰∫åÁª¥Á†ÅÂÆπÂô®');
                
                if (!currentBuildingName) {
                    alert('ËØ∑ÂÖàÈÄâÊã©‰∏Ä‰∏™ËΩ¶Èó¥ÊàñËÆæÊñΩ');
                    return;
                }
                
                if (currentFacilityCodes.length === 0) {
                    alert('ÂΩìÂâçÈÄâÊã©ÁöÑÈÉ®‰ΩçÊöÇÊó†ËÆæÊñΩÁ†Å‰ø°ÊÅØ');
                    return;
                }
                
                showFacilityQRCode();
                
                // ÊªöÂä®Âà∞È°∂ÈÉ®ÔºåÁ°Æ‰øù‰∫åÁª¥Á†ÅÂèØËßÅ
                window.scrollTo({ top: 0, behavior: 'smooth' });
            });
            
            // ‰∏ã‰∏Ä‰∏™ÊåâÈíÆÁÇπÂáª‰∫ã‰ª∂
            nextBtn.addEventListener('click', showNextFacilityCode);
            
            // ËΩ¶Èó¥‰∫åÁª¥Á†ÅÊâ´ÊèèÁ≥ªÁªü‰∫ã‰ª∂
            collapseAllBtn.addEventListener('click', function() {
                console.log('ÊäòÂè†ÊâÄÊúâÂàÜÁ±ª');
                const collapseButtons = document.querySelectorAll('.collapse-btn');
                const collapseContents = document.querySelectorAll('.collapse-content');
                
                collapseButtons.forEach(button => {
                    button.classList.add('collapsed');
                });
                
                collapseContents.forEach(content => {
                    content.classList.remove('expanded');
                });
            });
            
            backFromScanBtn.addEventListener('click', function() {
                console.log('‰ªéÊâ´ÊèèÁ≥ªÁªüËøîÂõû');
                // ÈöêËóèËΩ¶Èó¥‰∫åÁª¥Á†ÅÊâ´ÊèèÁ≥ªÁªüÔºåÊòæÁ§∫ËΩ¶Èó¥ÈÄâÊã©ÂºπÁ™ó
                qrScanSystem.classList.remove('active');
                facilityModal.classList.add('active');
            });
            
            // ‰∏∫‰∫åÁª¥Á†ÅÊ∑ªÂä†ÈïøÊåâ‰øùÂ≠òÊèêÁ§∫
            let pressTimer;
            document.addEventListener('touchstart', function(e) {
                if (e.target.closest('.qr-code-container-new')) {
                    pressTimer = setTimeout(() => {
                        showToast('ÈïøÊåâ‰∫åÁª¥Á†ÅÂèØ‰øùÂ≠òÂà∞Áõ∏ÂÜå');
                    }, 800);
                }
            });
            
            document.addEventListener('touchend', function() {
                clearTimeout(pressTimer);
            });
            
            document.addEventListener('touchmove', function() {
                clearTimeout(pressTimer);
            });
        }
        
        // ÁîüÊàêÊâìÂç°‰∫åÁª¥Á†Å
        function generateClockQRCode() {
            console.log('ÁîüÊàêÊâìÂç°‰∫åÁª¥Á†Å');
            // Êõ¥Êñ∞ÊñáÊú¨‰ø°ÊÅØ
            clockCodeText.textContent = CLOCK_QR_CODE;
            clockUrlText.textContent = CLOCK_QR_URL;
            
            // ÁîüÊàêQRÁ†ÅÂõæÁâá
            const qrSize = 250;
            const qrUrl = `https://api.qrserver.com/v1/create-qr-code/?size=${qrSize}x${qrSize}&data=${encodeURIComponent(CLOCK_QR_URL)}`;
            
            // ÂàõÂª∫ÂõæÁâá
            const img = new Image();
            img.alt = "‰∏ä‰∏ãÁè≠ÊâìÂç°‰∫åÁª¥Á†Å";
            
            // ÂõæÁâáÂä†ËΩΩÊàêÂäü
            img.onload = function() {
                clockQrPlaceholder.innerHTML = '';
                clockQrPlaceholder.appendChild(img);
                console.log('ÊâìÂç°‰∫åÁª¥Á†ÅÂä†ËΩΩÊàêÂäü');
            };
            
            // ÂõæÁâáÂä†ËΩΩÂ§±Ë¥•
            img.onerror = function() {
                clockQrPlaceholder.innerHTML = '<p>Êó†Ê≥ïÂä†ËΩΩ‰∫åÁª¥Á†ÅÔºåËØ∑Ê£ÄÊü•ÁΩëÁªúËøûÊé•</p>';
                console.log('ÊâìÂç°‰∫åÁª¥Á†ÅÂä†ËΩΩÂ§±Ë¥•');
            };
            
            img.src = qrUrl;
        }
        
        // Êõ¥Êñ∞Âª∫Á≠ëÁ†ÅÊòæÁ§∫
        function updateBuildingQRDisplay(name, code, type) {
            console.log('Êõ¥Êñ∞Âª∫Á≠ëÁ†ÅÊòæÁ§∫:', name, code);
            qrTitle.textContent = name;
            qrCodeText.textContent = code;
            
            // ÊûÑÂª∫ÂÆåÊï¥ÁöÑURL
            const fullUrl = BASE_QR_URL + code;
            qrUrlText.textContent = fullUrl;
            
            // ÊòæÁ§∫Âä†ËΩΩÁä∂ÊÄÅ
            qrImage.innerHTML = '<div class="loading-spinner"></div><p>Ê≠£Âú®ÁîüÊàê‰∫åÁª¥Á†Å...</p>';
            qrImage.className = 'loading';
            
            // ÂàõÂª∫QRÁ†ÅÂõæÁâá
            const img = new Image();
            img.alt = `${name}‰∫åÁª¥Á†Å`;
            
            // ËÆæÁΩÆÂõæÁâáÂä†ËΩΩÂÆåÊàêÁöÑÂõûË∞É
            img.onload = function() {
                qrImage.innerHTML = '';
                qrImage.appendChild(img);
                
                // ÁßªÈô§Âä†ËΩΩÁ±ª
                qrImage.classList.remove('loading');
                console.log('Âª∫Á≠ëÁ†Å‰∫åÁª¥Á†ÅÂä†ËΩΩÊàêÂäü');
            };
            
            // ËÆæÁΩÆÂõæÁâáÂä†ËΩΩÈîôËØØÁöÑÂõûË∞É
            img.onerror = function() {
                qrImage.innerHTML = '<p>Êó†Ê≥ïÂä†ËΩΩ‰∫åÁª¥Á†ÅÔºåËØ∑Ê£ÄÊü•ÁΩëÁªúËøûÊé•</p>';
                qrImage.classList.remove('loading');
                console.log('Âª∫Á≠ëÁ†Å‰∫åÁª¥Á†ÅÂä†ËΩΩÂ§±Ë¥•');
            };
            
            // ‰ΩøÁî®Á¨¨‰∏âÊñπAPIÁîüÊàêQRÁ†ÅÔºåÁºñÁ†ÅÂÆåÊï¥ÁöÑURL
            const qrSize = 250;
            const qrUrl = `https://api.qrserver.com/v1/create-qr-code/?size=${qrSize}x${qrSize}&data=${encodeURIComponent(fullUrl)}`;
            
            img.src = qrUrl;
        }
        
        // ÊòæÁ§∫ËÆæÊñΩÁ†Å
        function showFacilityQRCode() {
            console.log('ÊòæÁ§∫ËÆæÊñΩÁ†Å');
            if (currentFacilityCodes.length === 0) {
                alert('ÂΩìÂâçÈÄâÊã©ÁöÑÈÉ®‰ΩçÊöÇÊó†ËÆæÊñΩÁ†Å‰ø°ÊÅØ');
                return;
            }
            
            // Â¶ÇÊûúÊòØÁ¨¨‰∏ÄÊ¨°ËøõÂÖ•ËÆæÊñΩÊ®°ÂºèÔºåÈáçÁΩÆÁ¥¢Âºï
            if (!isFacilityMode) {
                currentFacilityIndex = 0;
                isFacilityMode = true;
                qrCodeContainer.classList.add('facility-mode-active');
                actionButtons.style.display = 'flex';
            }
            
            // Ëé∑ÂèñÂΩìÂâçËÆæÊñΩÁ†Å
            const facilityCode = currentFacilityCodes[currentFacilityIndex];
            
            // Êõ¥Êñ∞ÊòæÁ§∫
            instruction.textContent = `ËÆæÊñΩÁ†Å ${currentFacilityIndex + 1}/${currentFacilityCodes.length}`;
            qrTitle.textContent = `${currentBuildingName} - ${facilityCode.name}`;
            qrCodeText.textContent = facilityCode.code;
            qrUrlText.textContent = facilityCode.url;
            
            // ÊòæÁ§∫Âä†ËΩΩÁä∂ÊÄÅ
            qrImage.innerHTML = '<div class="loading-spinner"></div><p>Ê≠£Âú®ÁîüÊàê‰∫åÁª¥Á†Å...</p>';
            qrImage.className = 'loading';
            
            // ÂàõÂª∫QRÁ†ÅÂõæÁâá
            const img = new Image();
            img.alt = `${facilityCode.name}‰∫åÁª¥Á†Å`;
            
            // ËÆæÁΩÆÂõæÁâáÂä†ËΩΩÂÆåÊàêÁöÑÂõûË∞É
            img.onload = function() {
                qrImage.innerHTML = '';
                qrImage.appendChild(img);
                
                // ÁßªÈô§Âä†ËΩΩÁ±ª
                qrImage.classList.remove('loading');
                console.log('ËÆæÊñΩÁ†Å‰∫åÁª¥Á†ÅÂä†ËΩΩÊàêÂäü');
            };
            
            // ËÆæÁΩÆÂõæÁâáÂä†ËΩΩÈîôËØØÁöÑÂõûË∞É
            img.onerror = function() {
                qrImage.innerHTML = '<p>Êó†Ê≥ïÂä†ËΩΩ‰∫åÁª¥Á†ÅÔºåËØ∑Ê£ÄÊü•ÁΩëÁªúËøûÊé•</p>';
                qrImage.classList.remove('loading');
                console.log('ËÆæÊñΩÁ†Å‰∫åÁª¥Á†ÅÂä†ËΩΩÂ§±Ë¥•');
            };
            
            // ‰ΩøÁî®Á¨¨‰∏âÊñπAPIÁîüÊàêQRÁ†Å
            const qrSize = 250;
            const qrUrl = `https://api.qrserver.com/v1/create-qr-code/?size=${qrSize}x${qrSize}&data=${encodeURIComponent(facilityCode.url)}`;
            
            img.src = qrUrl;
        }
        
        // ÊòæÁ§∫‰∏ã‰∏Ä‰∏™ËÆæÊñΩÁ†Å
        function showNextFacilityCode() {
            console.log('ÊòæÁ§∫‰∏ã‰∏Ä‰∏™ËÆæÊñΩÁ†Å');
            if (currentFacilityCodes.length === 0 || !isFacilityMode) {
                return;
            }
            
            // Êõ¥Êñ∞Á¥¢ÂºïÔºàÂæ™ÁéØÔºâ
            currentFacilityIndex = (currentFacilityIndex + 1) % currentFacilityCodes.length;
            
            // ÊòæÁ§∫Êñ∞ÁöÑËÆæÊñΩÁ†Å
            showFacilityQRCode();
            
            // ÊªöÂä®Âà∞È°∂ÈÉ®ÔºåÁ°Æ‰øù‰∫åÁª¥Á†ÅÂèØËßÅ
            window.scrollTo({ top: 0, behavior: 'smooth' });
        }
        
        // ÊòæÁ§∫ÊèêÁ§∫‰ø°ÊÅØ
        function showToast(message) {
            toast.textContent = message;
            toast.classList.add('show');
            
            setTimeout(() => {
                toast.classList.remove('show');
            }, 3000);
        }
        
        // Â§çÂà∂Âà∞Ââ™Ë¥¥ÊùøÂáΩÊï∞
        function copyToClipboard(text) {
            // Ê£ÄÊü•ÊòØÂê¶ÊîØÊåÅclipboard API
            if (navigator.clipboard && window.isSecureContext) {
                navigator.clipboard.writeText(text).then(function() {
                    showToast('ÈìæÊé•Â∑≤Â§çÂà∂Âà∞Ââ™Ë¥¥ÊùøÔºÅ');
                    console.log('ÈìæÊé•Â∑≤Â§çÂà∂:', text);
                }).catch(function(err) {
                    console.error('Â§çÂà∂Â§±Ë¥•:', err);
                    // Â§áÁî®ÊñπÊ≥ï
                    fallbackCopyText(text);
                });
            } else {
                // ‰ΩøÁî®Â§áÁî®ÊñπÊ≥ï
                fallbackCopyText(text);
            }
        }
        
        // Â§áÁî®Â§çÂà∂ÊñπÊ≥ï
        function fallbackCopyText(text) {
            const textArea = document.createElement('textarea');
            textArea.value = text;
            
            // Èò≤Ê≠¢Â±èÂπïÊªöÂä®
            textArea.style.position = 'fixed';
            textArea.style.left = '-999999px';
            textArea.style.top = '-999999px';
            document.body.appendChild(textArea);
            textArea.focus();
            textArea.select();
            
            try {
                const successful = document.execCommand('copy');
                if (successful) {
                    showToast('ÈìæÊé•Â∑≤Â§çÂà∂Âà∞Ââ™Ë¥¥ÊùøÔºÅ');
                    console.log('ÈìæÊé•Â∑≤Â§çÂà∂:', text);
                } else {
                    console.error('Â§áÁî®Â§çÂà∂ÊñπÊ≥ïÂ§±Ë¥•');
                    showToast('Â§çÂà∂Â§±Ë¥•ÔºåËØ∑ÊâãÂä®Â§çÂà∂ÈìæÊé•');
                }
            } catch (err) {
                console.error('Â§áÁî®Â§çÂà∂ÊñπÊ≥ïÂºÇÂ∏∏:', err);
                showToast('Â§çÂà∂Â§±Ë¥•ÔºåËØ∑ÊâãÂä®Â§çÂà∂ÈìæÊé•');
            }
            
            document.body.removeChild(textArea);
        }
    </script>
</body>
</html>