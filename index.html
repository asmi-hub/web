<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ğŸ¥· å¼±æ°´ä¸‰åƒåªå–ä¸€ç“¢</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', 'Microsoft YaHei', sans-serif;
        }
        
        :root {
            --primary-color: #6366f1;
            --primary-dark: #4f46e5;
            --bg-dark: #0f172a;
            --bg-card: #1e293b;
            --bg-card-light: #334155;
            --text-primary: #f1f5f9;
            --text-secondary: #94a3b8;
            --border-color: #475569;
            --shadow-color: rgba(0, 0, 0, 0.3);
            --success-color: #10b981;
        }
        
        body {
            background-color: var(--bg-dark);
            color: var(--text-primary);
            line-height: 1.6;
            padding: 16px;
            min-height: 100vh;
            background-image: 
                radial-gradient(circle at 20% 30%, rgba(99, 102, 241, 0.1) 0%, transparent 50%),
                radial-gradient(circle at 80% 70%, rgba(79, 70, 229, 0.08) 0%, transparent 50%);
        }
        
        /* æ¬¢è¿å¼¹çª—æ ·å¼ */
        .welcome-modal {
            display: flex; /* æ”¹ä¸ºflexï¼Œé»˜è®¤æ˜¾ç¤º */
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: rgba(15, 23, 42, 0.9);
            z-index: 1000;
            justify-content: center;
            align-items: center;
            backdrop-filter: blur(5px);
        }
        
        .welcome-modal.hidden {
            display: none; /* ä½¿ç”¨hiddenç±»æ¥éšè— */
        }
        
        .modal-content {
            background-color: var(--bg-card);
            border-radius: 20px;
            padding: 40px;
            max-width: 500px;
            width: 90%;
            box-shadow: 0 20px 50px rgba(0, 0, 0, 0.5);
            text-align: center;
            border: 2px solid var(--primary-color);
            animation: modalAppear 0.5s ease-out;
        }
        
        @keyframes modalAppear {
            from {
                opacity: 0;
                transform: translateY(-30px) scale(0.95);
            }
            to {
                opacity: 1;
                transform: translateY(0) scale(1);
            }
        }
        
        .modal-icon {
            font-size: 4rem;
            color: var(--primary-color);
            margin-bottom: 20px;
        }
        
        .modal-title {
            font-size: 2rem;
            color: var(--text-primary);
            margin-bottom: 10px;
        }
        
        .modal-subtitle {
            color: var(--text-secondary);
            font-size: 1.1rem;
            margin-bottom: 30px;
            line-height: 1.5;
        }
        
        .modal-buttons {
            display: flex;
            flex-direction: column;
            gap: 16px;
            margin-top: 30px;
        }
        
        .modal-btn {
            padding: 18px 30px;
            border: none;
            border-radius: 14px;
            font-size: 1.2rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 12px;
            box-shadow: 0 6px 20px rgba(0, 0, 0, 0.2);
        }
        
        .modal-btn.inspection {
            background-color: var(--success-color);
            color: white;
        }
        
        .modal-btn.inspection:hover {
            background-color: #0da271;
            transform: translateY(-4px);
            box-shadow: 0 10px 25px rgba(16, 185, 129, 0.4);
        }
        
        .modal-btn.clock {
            background-color: var(--primary-color);
            color: white;
        }
        
        .modal-btn.clock:hover {
            background-color: var(--primary-dark);
            transform: translateY(-4px);
            box-shadow: 0 10px 25px rgba(99, 102, 241, 0.4);
        }
        
        .modal-btn i {
            font-size: 1.3rem;
        }
        
        /* æ‰“å¡å¼¹çª—æ ·å¼ */
        .clock-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: rgba(15, 23, 42, 0.95);
            z-index: 1001;
            justify-content: center;
            align-items: center;
            backdrop-filter: blur(5px);
        }
        
        .clock-modal.active {
            display: flex;
        }
        
        .clock-modal-content {
            background-color: var(--bg-card);
            border-radius: 20px;
            padding: 30px;
            max-width: 400px;
            width: 90%;
            box-shadow: 0 20px 50px rgba(0, 0, 0, 0.5);
            text-align: center;
            border: 2px solid var(--success-color);
            animation: modalAppear 0.5s ease-out;
        }
        
        .clock-modal-header {
            margin-bottom: 25px;
        }
        
        .clock-modal-title {
            font-size: 1.8rem;
            color: var(--text-primary);
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 12px;
        }
        
        .clock-modal-subtitle {
            color: var(--text-secondary);
            font-size: 1rem;
        }
        
        .clock-qr-container {
            background-color: var(--bg-card-light);
            border-radius: 16px;
            padding: 20px;
            margin: 20px 0;
            display: flex;
            justify-content: center;
            align-items: center;
            border: 2px solid var(--border-color);
        }
        
        .clock-qr-placeholder {
            width: 250px;
            height: 250px;
            background-color: white;
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            overflow: hidden;
            padding: 10px;
        }
        
        .clock-qr-placeholder img {
            width: 100%;
            height: 100%;
            object-fit: contain;
        }
        
        .clock-info {
            margin: 20px 0;
            text-align: center;
        }
        
        .clock-code {
            font-family: 'Courier New', monospace;
            background-color: rgba(0, 0, 0, 0.3);
            padding: 12px;
            border-radius: 10px;
            font-size: 0.9rem;
            color: var(--text-primary);
            margin-bottom: 15px;
            border: 1px solid var(--border-color);
        }
        
        .clock-url {
            font-size: 0.8rem;
            color: var(--text-secondary);
            word-break: break-all;
            background-color: rgba(0, 0, 0, 0.2);
            padding: 10px;
            border-radius: 8px;
            border: 1px solid var(--border-color);
        }
        
        .clock-modal-buttons {
            margin-top: 25px;
        }
        
        .clock-close-btn {
            padding: 14px 30px;
            background-color: var(--bg-card-light);
            border: none;
            border-radius: 12px;
            color: var(--text-primary);
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            width: 100%;
            font-size: 1rem;
        }
        
        .clock-close-btn:hover {
            background-color: var(--border-color);
            transform: translateY(-3px);
        }
        
        /* è½¦é—´é€‰æ‹©å¼¹çª— */
        .facility-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: rgba(15, 23, 42, 0.95);
            z-index: 1002;
            justify-content: center;
            align-items: center;
            backdrop-filter: blur(5px);
        }
        
        .facility-modal.active {
            display: flex;
        }
        
        .facility-modal-content {
            background-color: var(--bg-card);
            border-radius: 20px;
            padding: 30px;
            max-width: 900px;
            width: 95%;
            max-height: 85vh;
            box-shadow: 0 20px 50px rgba(0, 0, 0, 0.5);
            display: flex;
            flex-direction: column;
            border: 2px solid var(--primary-color);
            animation: modalAppear 0.5s ease-out;
        }
        
        .facility-modal-header {
            margin-bottom: 25px;
            text-align: center;
            position: relative;
        }
        
        .facility-modal-title {
            font-size: 1.8rem;
            color: var(--text-primary);
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 12px;
        }
        
        .facility-modal-subtitle {
            color: var(--text-secondary);
            font-size: 1rem;
        }
        
        .facility-close-btn {
            position: absolute;
            top: 0;
            right: 0;
            background-color: var(--bg-card-light);
            border: none;
            border-radius: 10px;
            color: var(--text-primary);
            width: 40px;
            height: 40px;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.2rem;
        }
        
        .facility-close-btn:hover {
            background-color: var(--border-color);
            transform: translateY(-3px);
        }
        
        .facility-buttons-container {
            flex: 1;
            overflow-y: auto;
            padding-right: 5px;
        }
        
        .facility-buttons-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(180px, 1fr));
            gap: 18px;
        }
        
        .facility-btn {
            padding: 20px 15px;
            background-color: var(--bg-card-light);
            border: none;
            border-radius: 12px;
            color: var(--text-primary);
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            text-align: center;
            font-size: 1.1rem;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            min-height: 100px;
            position: relative;
            overflow: hidden;
        }
        
        .facility-btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 3px;
            background: var(--primary-color);
            transform: scaleX(0);
            transition: transform 0.3s ease;
        }
        
        .facility-btn:hover {
            background-color: var(--primary-color);
            transform: translateY(-6px);
            box-shadow: 0 8px 25px rgba(99, 102, 241, 0.3);
        }
        
        .facility-btn:hover::before {
            transform: scaleX(1);
        }
        
        .facility-btn.active {
            background-color: var(--primary-color);
            color: white;
            box-shadow: 0 6px 20px rgba(99, 102, 241, 0.4);
        }
        
        .facility-btn.active::before {
            transform: scaleX(1);
        }
        
        .facility-btn .type-tag {
            font-size: 0.8rem;
            background: rgba(255, 255, 255, 0.15);
            padding: 4px 12px;
            border-radius: 10px;
            margin-top: 10px;
            font-weight: normal;
        }
        
        /* ä¸»å†…å®¹ - äºŒç»´ç å±•ç¤ºé¡µé¢ */
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0;
            display: none;
        }
        
        .container.active {
            display: block;
        }
        
        .content {
            display: flex;
            flex-direction: column;
            gap: 24px;
        }
        
        .qr-display {
            background-color: var(--bg-card);
            border-radius: 16px;
            padding: 24px 16px;
            box-shadow: 0 8px 25px var(--shadow-color);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            position: relative;
        }
        
        .qr-display h2 {
            color: var(--text-primary);
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 2px solid var(--border-color);
            width: 100%;
            text-align: center;
            font-size: 1.3rem;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 12px;
        }
        
        .qr-display-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            width: 100%;
            margin-bottom: 20px;
            flex-wrap: wrap;
            gap: 12px;
        }
        
        /* è¿”å›é€‰æ‹©æŒ‰é’® - ç‹¬ç«‹æ ·å¼ */
        .back-to-facility-container {
            position: absolute;
            top: 24px;
            left: 24px;
            z-index: 10;
        }
        
        .back-to-facility-btn {
            padding: 12px 20px;
            border: none;
            border-radius: 10px;
            background-color: var(--bg-card-light);
            color: var(--text-primary);
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            font-size: 0.95rem;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
            white-space: nowrap;
        }
        
        .back-to-facility-btn:hover {
            background-color: var(--primary-color);
            color: white;
            transform: translateY(-3px);
            box-shadow: 0 6px 18px rgba(99, 102, 241, 0.4);
        }
        
        .back-to-facility-btn i {
            font-size: 1rem;
        }
        
        /* äºŒç»´ç å®¹å™¨ - æ·»åŠ ç‚¹å‡»æ•ˆæœ */
        .qr-code-container {
            background-color: var(--bg-card-light);
            border-radius: 16px;
            padding: 24px;
            width: 100%;
            max-width: 320px;
            display: flex;
            flex-direction: column;
            align-items: center;
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.2);
            margin-bottom: 10px;
            margin-top: 10px;
            transition: all 0.3s ease;
            cursor: pointer;
            position: relative;
        }
        
        .qr-code-container:hover {
            transform: translateY(-5px);
            box-shadow: 0 12px 25px rgba(0, 0, 0, 0.3);
        }
        
        .qr-code-container.facility-mode-active {
            border: 2px solid var(--primary-color);
            box-shadow: 0 12px 30px rgba(99, 102, 241, 0.3);
        }
        
        .qr-placeholder {
            width: 100%;
            max-width: 280px;
            height: 280px;
            background-color: white;
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-bottom: 20px;
            border: 2px solid var(--border-color);
            overflow: hidden;
            position: relative;
            padding: 10px;
            transition: all 0.3s ease;
        }
        
        .qr-placeholder:hover {
            border-color: var(--primary-color);
        }
        
        .qr-placeholder img {
            width: 100%;
            height: 100%;
            object-fit: contain;
        }
        
        /* ç‚¹å‡»æç¤º - å·²ç§»é™¤æŒ‰é’®ä½†ä¿ç•™åŠŸèƒ½ */
        
        /* è®¾æ–½ç æ¨¡å¼æç¤º */
        .facility-mode-hint {
            position: absolute;
            top: -10px;
            left: 50%;
            transform: translateX(-50%);
            background-color: var(--primary-color);
            color: white;
            padding: 6px 15px;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: 600;
            box-shadow: 0 4px 12px rgba(99, 102, 241, 0.4);
            z-index: 5;
            display: none;
        }
        
        .qr-code-container.facility-mode-active .facility-mode-hint {
            display: block;
        }
        
        .qr-info {
            text-align: center;
            width: 100%;
        }
        
        .qr-title {
            font-size: 1.3rem;
            color: var(--text-primary);
            margin-bottom: 12px;
            font-weight: 700;
            line-height: 1.4;
            padding: 0 10px;
        }
        
        .qr-code {
            font-family: 'Courier New', monospace;
            background-color: rgba(0, 0, 0, 0.3);
            padding: 12px;
            border-radius: 10px;
            margin: 16px 0;
            font-size: 0.9rem;
            color: var(--text-primary);
            letter-spacing: 1px;
            overflow-x: auto;
            white-space: nowrap;
            width: 100%;
            border: 1px solid var(--border-color);
        }
        
        .qr-url-container {
            margin: 16px 0;
            width: 100%;
        }
        
        .qr-url-label {
            font-size: 0.9rem;
            color: var(--text-secondary);
            margin-bottom: 8px;
            text-align: left;
        }
        
        .qr-url {
            font-family: 'Courier New', monospace;
            background-color: rgba(0, 0, 0, 0.3);
            padding: 12px;
            border-radius: 10px;
            font-size: 0.75rem;
            color: var(--text-primary);
            word-break: break-all;
            max-height: 100px;
            overflow-y: auto;
            width: 100%;
            text-align: left;
            border: 1px solid var(--border-color);
            line-height: 1.5;
        }
        
        .instruction {
            color: var(--text-secondary);
            font-size: 0.9rem;
            margin-top: 16px;
            text-align: center;
            padding: 0 10px;
        }
        
        .loading {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            height: 100%;
            width: 100%;
        }
        
        .loading-spinner {
            width: 50px;
            height: 50px;
            border: 4px solid rgba(255, 255, 255, 0.1);
            border-top: 4px solid var(--primary-color);
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin-bottom: 16px;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        .action-buttons {
            display: flex;
            gap: 12px;
            margin-top: 20px;
            width: 100%;
            justify-content: center;
            max-width: 300px;
        }
        
        .action-btn {
            padding: 14px 24px;
            border: none;
            border-radius: 12px;
            background-color: var(--primary-color);
            color: white;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            flex: 1;
            max-width: 200px;
            font-size: 1rem;
            box-shadow: 0 4px 12px rgba(99, 102, 241, 0.3);
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }
        
        .action-btn:hover {
            background-color: var(--primary-dark);
            transform: translateY(-3px);
            box-shadow: 0 6px 18px rgba(99, 102, 241, 0.4);
        }
        
        .action-btn.next {
            background-color: var(--success-color);
        }
        
        .action-btn.next:hover {
            background-color: #0da271;
        }
        
        .action-btn:disabled {
            background-color: var(--border-color);
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }
        
        footer {
            margin-top: 30px;
            text-align: center;
            color: var(--text-secondary);
            font-size: 0.85rem;
            padding-top: 20px;
            border-top: 1px solid var(--border-color);
        }
        
        /* æ‰‹æœºä¼˜åŒ– */
        @media (max-width: 768px) {
            body {
                padding: 12px;
            }
            
            .modal-content {
                padding: 30px 20px;
            }
            
            .modal-title {
                font-size: 1.7rem;
            }
            
            .modal-btn {
                padding: 16px 20px;
                font-size: 1.1rem;
            }
            
            .clock-modal-content {
                padding: 25px 20px;
            }
            
            .clock-modal-title {
                font-size: 1.5rem;
            }
            
            .clock-qr-placeholder {
                width: 220px;
                height: 220px;
            }
            
            .facility-modal-content {
                padding: 20px 15px;
                max-width: 95%;
            }
            
            .facility-buttons-grid {
                grid-template-columns: repeat(auto-fill, minmax(140px, 1fr));
                gap: 14px;
            }
            
            .facility-btn {
                padding: 16px 12px;
                font-size: 1rem;
                min-height: 90px;
            }
            
            .qr-display {
                padding: 24px 12px;
            }
            
            /* ç§»åŠ¨ç«¯è°ƒæ•´æŒ‰é’®ä½ç½® */
            .back-to-facility-container {
                position: relative;
                top: auto;
                left: auto;
                margin-bottom: 15px;
                width: 100%;
            }
            
            .back-to-facility-btn {
                width: 100%;
                justify-content: center;
            }
            
            .qr-code-container {
                padding: 20px 16px;
                margin-top: 10px;
            }
            
            .qr-placeholder {
                max-width: 260px;
                height: 260px;
            }
            
            .qr-title {
                font-size: 1.2rem;
            }
            
            .qr-code {
                font-size: 0.85rem;
                padding: 10px;
            }
            
            .qr-url {
                font-size: 0.7rem;
                padding: 10px;
            }
            
            .action-btn {
                padding: 12px 20px;
                font-size: 0.95rem;
            }
        }
        
        @media (max-width: 480px) {
            .modal-content {
                padding: 25px 15px;
            }
            
            .modal-title {
                font-size: 1.5rem;
            }
            
            .modal-subtitle {
                font-size: 1rem;
            }
            
            .modal-btn {
                padding: 14px 16px;
                font-size: 1rem;
            }
            
            .clock-qr-placeholder {
                width: 200px;
                height: 200px;
            }
            
            .facility-buttons-grid {
                grid-template-columns: repeat(2, 1fr);
            }
            
            .facility-btn .type-tag {
                font-size: 0.75rem;
                padding: 3px 8px;
            }
            
            .qr-placeholder {
                max-width: 240px;
                height: 240px;
            }
            
            .action-buttons {
                flex-direction: column;
                align-items: center;
            }
            
            .action-btn {
                max-width: 100%;
                width: 100%;
            }
        }
        
        /* æ»šåŠ¨æ¡æ ·å¼ */
        ::-webkit-scrollbar {
            width: 6px;
            height: 6px;
        }
        
        ::-webkit-scrollbar-track {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 3px;
        }
        
        ::-webkit-scrollbar-thumb {
            background: var(--primary-color);
            border-radius: 3px;
        }
        
        ::-webkit-scrollbar-thumb:hover {
            background: var(--primary-dark);
        }
        
        /* äºŒç»´ç å®¹å™¨ä¼˜åŒ–ï¼Œç¡®ä¿æ— é®æŒ¡ */
        .qr-code-wrapper {
            position: relative;
            width: 100%;
            display: flex;
            justify-content: center;
        }
    </style>
</head>
<body>
    <!-- æ¬¢è¿å¼¹çª— -->
    <div class="welcome-modal" id="welcomeModal">
        <div class="modal-content">
            <div class="modal-icon">
                <i class="fas fa-shield-alt"></i>
            </div>
            <h1 class="modal-title">æ¶ˆé˜²è®¾æ–½å·¡æŸ¥ç³»ç»Ÿ</h1>
            <p class="modal-subtitle">KingLong æ¶ˆé˜²è®¾æ–½å·¡æŸ¥ç³»ç»Ÿ<br>è¯·é€‰æ‹©è¦è¿›è¡Œçš„æ“ä½œ</p>
            
            <div class="modal-buttons">
                <button class="modal-btn inspection" id="startInspectionBtn">
                    <i class="fas fa-search"></i> å¼€å§‹å·¡æŸ¥ä»»åŠ¡
                </button>
                <button class="modal-btn clock" id="clockInOutBtn">
                    <i class="fas fa-user-clock"></i> ä¸Šä¸‹ç­æ‰“å¡
                </button>
            </div>
        </div>
    </div>
    
    <!-- æ‰“å¡å¼¹çª— -->
    <div class="clock-modal" id="clockModal">
        <div class="clock-modal-content">
            <div class="clock-modal-header">
                <h2 class="clock-modal-title">
                    <i class="fas fa-user-clock"></i> ä¸Šä¸‹ç­æ‰“å¡
                </h2>
                <p class="clock-modal-subtitle">è¯·æ‰«æä¸‹æ–¹äºŒç»´ç è¿›è¡Œä¸Šä¸‹ç­æ‰“å¡</p>
            </div>
            
            <div class="clock-qr-container">
                <div class="clock-qr-placeholder" id="clockQrPlaceholder">
                    <div class="loading">
                        <div class="loading-spinner"></div>
                        <p>æ­£åœ¨ç”Ÿæˆæ‰“å¡äºŒç»´ç ...</p>
                    </div>
                </div>
            </div>
            
            <div class="clock-info">
                <div class="clock-code" id="clockCodeText">S0000007287810</div>
                <div class="clock-url" id="clockUrlText">https://zhxf.fj.119.gov.cn:8081/xgj/gzfw?qr=S0000007287810</div>
            </div>
            
            <div class="clock-modal-buttons">
                <button class="clock-close-btn" id="closeClockModalBtn">
                    <i class="fas fa-times"></i> å…³é—­
                </button>
            </div>
        </div>
    </div>
    
    <!-- è½¦é—´é€‰æ‹©å¼¹çª— -->
    <div class="facility-modal" id="facilityModal">
        <div class="facility-modal-content">
            <div class="facility-modal-header">
                <h2 class="facility-modal-title">
                    <i class="fas fa-building"></i> è½¦é—´ä¸è®¾æ–½åˆ—è¡¨
                </h2>
                <p class="facility-modal-subtitle">ç‚¹å‡»ä»»æ„è½¦é—´æˆ–è®¾æ–½æŸ¥çœ‹äºŒç»´ç </p>
                <button class="facility-close-btn" id="facilityCloseBtn">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            
            <div class="facility-buttons-container">
                <div class="facility-buttons-grid" id="facilityButtonsGrid">
                    <!-- è½¦é—´è®¾æ–½æŒ‰é’®å°†åœ¨è¿™é‡ŒåŠ¨æ€ç”Ÿæˆ -->
                </div>
            </div>
        </div>
    </div>
    
    <!-- ä¸»å†…å®¹ - äºŒç»´ç å±•ç¤ºé¡µé¢ -->
    <div class="container" id="mainContainer">
        <div class="content">
            <div class="qr-display">
                <!-- è¿”å›é€‰æ‹©æŒ‰é’® - ç‹¬ç«‹ä½ç½® -->
                <div class="back-to-facility-container">
                    <button class="back-to-facility-btn" id="backToFacilityBtn">
                        <i class="fas fa-arrow-left"></i> è¿”å›é€‰æ‹©
                    </button>
                </div>
                
                <h2><i class="fas fa-qrcode"></i> é—½æ”¿é€šæ¶ˆç®¡å®¶äºŒç»´ç </h2>
                
                <div class="qr-code-wrapper">
                    <div class="qr-code-container" id="qrCodeContainer">
                        <!-- è®¾æ–½ç æ¨¡å¼æç¤º -->

                        
                        <div class="qr-placeholder">
                            <div id="qr-image" class="loading">
                                <div class="loading-spinner"></div>
                                <p>åŠ è½½ä¸­...</p>
                            </div>
                        </div>
                        <div class="qr-info">
                            <div class="qr-title" id="qr-title">è¯·é€‰æ‹©è½¦é—´æˆ–è®¾æ–½</div>
                            <div class="qr-code" id="qr-code-text">B0000000000000</div>
                            <div class="qr-url-container">
                                <div class="qr-url-label">è®¿é—®é“¾æ¥ï¼š</div>
                                <div class="qr-url" id="qr-url-text">https://zhxf.fj.119.gov.cn:8081/xgj/gzfw?qr=B0000000000000</div>
                            </div>
                            
                            <div class="action-buttons" id="action-buttons" style="display: none;">
                                <button class="action-btn next" id="next-btn">
                                    <i class="fas fa-arrow-right"></i> ä¸‹ä¸€ä¸ªè®¾æ–½ç 
                                </button>
                            </div>
                            
                            <p class="instruction" id="instruction">ä½¿ç”¨æ‰‹æœºæ‰«æäºŒç»´ç æŸ¥çœ‹è¯¦ç»†ä¿¡æ¯</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <footer>
            <p>KingLong è®¾æ–½ç  &copy; 2026</p>
        </footer>
    </div>

    <script>
        // è·å–å¼¹çª—ç›¸å…³DOMå…ƒç´ 
        const welcomeModal = document.getElementById('welcomeModal');
        const clockModal = document.getElementById('clockModal');
        const facilityModal = document.getElementById('facilityModal');
        const mainContainer = document.getElementById('mainContainer');
        const startInspectionBtn = document.getElementById('startInspectionBtn');
        const clockInOutBtn = document.getElementById('clockInOutBtn');
        const closeClockModalBtn = document.getElementById('closeClockModalBtn');
        const facilityCloseBtn = document.getElementById('facilityCloseBtn');
        const facilityButtonsGrid = document.getElementById('facilityButtonsGrid');
        const backToFacilityBtn = document.getElementById('backToFacilityBtn');
        const clockQrPlaceholder = document.getElementById('clockQrPlaceholder');
        const clockCodeText = document.getElementById('clockCodeText');
        const clockUrlText = document.getElementById('clockUrlText');
        
        // è·å–äºŒç»´ç å±•ç¤ºé¡µé¢DOMå…ƒç´ 
        const qrCodeContainer = document.getElementById('qrCodeContainer');
        const qrTitle = document.getElementById('qr-title');
        const qrCodeText = document.getElementById('qr-code-text');
        const qrUrlText = document.getElementById('qr-url-text');
        const qrImage = document.getElementById('qr-image');
        const actionButtons = document.getElementById('action-buttons');
        const nextBtn = document.getElementById('next-btn');
        const instruction = document.getElementById('instruction');
        const clickHint = document.getElementById('clickHint');
        
        // æ‰“å¡QRç ä¿¡æ¯
        const CLOCK_QR_CODE = "S0000007287810";
        const CLOCK_QR_URL = "https://zhxf.fj.119.gov.cn:8081/xgj/gzfw?qr=S0000007287810";
        
        // åŸºç¡€QRç URL
        const BASE_QR_URL = "https://zhxf.fj.119.gov.cn:8081/xgj/gzfw?qr=";
        
        // è½¦é—´ä¸è®¾æ–½æ•°æ®
        const facilities = [
            { name: "æ€»è£…è½¦é—´", code: "B0000006340822", type: "è½¦é—´" },
            { name: "ç„Šè£…è½¦é—´", code: "B0000006340824", type: "è½¦é—´" },
            { name: "ç”µæ³³è½¦é—´", code: "B0000006340826", type: "è½¦é—´" },
            { name: "æ¶‚è£…è½¦é—´", code: "B0000006340830", type: "è½¦é—´" },
            { name: "ç‰¹ç§æ¶‚è£…è½¦é—´", code: "B0000006340835", type: "è½¦é—´" },
            { name: "è¯•åˆ¶è½¦é—´", code: "B0000006340839", type: "è½¦é—´" },
            { name: "æ¸…æ´æ¥¼", code: "B0000006340868", type: "è®¾æ–½" },
            { name: "å……ç”µæ¡©", code: "B0000006340870", type: "è®¾æ–½" },
            { name: "è”åˆåŠ¨åŠ›ç«™æˆ¿", code: "B0000006343282", type: "è®¾æ–½" },
            { name: "æ±¡æ°´å¤„ç†ç«™", code: "B0000006343285", type: "è®¾æ–½" },
            { name: "å®¢æˆ·æœåŠ¡ä¸­å¿ƒ", code: "B0000006343279", type: "åŠå…¬æ¥¼" },
            { name: "Aæ ‹åŠå…¬æ¥¼", code: "B0000006340896", type: "åŠå…¬æ¥¼" },
            { name: "Bæ ‹åŠå…¬æ¥¼", code: "B0000006340900", type: "åŠå…¬æ¥¼" },
            { name: "Eæ ‹åŠå…¬æ¥¼", code: "B0000006341172", type: "åŠå…¬æ¥¼" }
        ];
        
        // è®¾æ–½ç æ•°æ®
        const facilityCodes = {
            "Aæ ‹åŠå…¬æ¥¼": [
                { name: "ç­ç«å™¨", code: "S0000009736239", url: "https://zhxf.fj.119.gov.cn:8081/xgj/gzfw?qr=S0000009736239" },
                { name: "ç–æ•£æŒ‡ç¤º", code: "S0000009735960", url: "https://zhxf.fj.119.gov.cn:8081/xgj/gzfw?qr=S0000009735960" },
                { name: "ç–æ•£æ¥¼æ¢¯", code: "S0000009735961", url: "https://zhxf.fj.119.gov.cn:8081/xgj/gzfw?qr=S0000009735961" },
                { name: "åº”æ€¥ç…§æ˜", code: "S0000009735962", url: "https://zhxf.fj.119.gov.cn:8081/xgj/gzfw?qr=S0000009735962" }
            ],
            "Bæ ‹åŠå…¬æ¥¼": [
                { name: "ç­ç«å™¨", code: "S0000009736238", url: "https://zhxf.fj.119.gov.cn:8081/xgj/gzfw?qr=S0000009736238" },
                { name: "ç–æ•£æŒ‡ç¤º", code: "S0000009735968", url: "https://zhxf.fj.119.gov.cn:8081/xgj/gzfw?qr=S0000009735968" },
                { name: "ç–æ•£æ¥¼æ¢¯", code: "S0000009735965", url: "https://zhxf.fj.119.gov.cn:8081/xgj/gzfw?qr=S0000009735965" },
                { name: "åº”æ€¥ç…§æ˜", code: "S0000009735969", url: "https://zhxf.fj.119.gov.cn:8081/xgj/gzfw?qr=S0000009735969" }
            ],
            "Eæ ‹åŠå…¬æ¥¼": [
                { name: "ç­ç«å™¨", code: "S0000009736236", url: "https://zhxf.fj.119.gov.cn:8081/xgj/gzfw?qr=S0000009736236" },
                { name: "ç–æ•£æŒ‡ç¤º", code: "S0000009736139", url: "https://zhxf.fj.119.gov.cn:8081/xgj/gzfw?qr=S0000009736139" },
                { name: "ç–æ•£æ¥¼æ¢¯", code: "S0000009736137", url: "https://zhxf.fj.119.gov.cn:8081/xgj/gzfw?qr=S0000009736137" },
                { name: "åº”æ€¥ç…§æ˜", code: "S0000009736140", url: "https://zhxf.fj.119.gov.cn:8081/xgj/gzfw?qr=S0000009736140" }
            ],
            "å®¢æˆ·æœåŠ¡ä¸­å¿ƒ": [
                { name: "ç­ç«å™¨", code: "S0000009736231", url: "https://zhxf.fj.119.gov.cn:8081/xgj/gzfw?qr=S0000009736231" },
                { name: "ç–æ•£æŒ‡ç¤º", code: "S0000009736269", url: "https://zhxf.fj.119.gov.cn:8081/xgj/gzfw?qr=S0000009736269" },
                { name: "ç–æ•£æ¥¼æ¢¯", code: "S0000009736194", url: "https://zhxf.fj.119.gov.cn:8081/xgj/gzfw?qr=S0000009736194" },
                { name: "åº”æ€¥ç…§æ˜", code: "S0000009736157", url: "https://zhxf.fj.119.gov.cn:8081/xgj/gzfw?qr=S0000009736157" }
            ],
            "æ€»è£…è½¦é—´": [
                { name: "ç­ç«å™¨", code: "S0000009736223", url: "https://zhxf.fj.119.gov.cn:8081/xgj/gzfw?qr=S0000009736223" },
                { name: "å®‰å…¨å‡ºå£", code: "S0000009735858", url: "https://zhxf.fj.119.gov.cn:8081/xgj/gzfw?qr=S0000009735858" },
                { name: "ç–æ•£æŒ‡ç¤º", code: "S0000009735859", url: "https://zhxf.fj.119.gov.cn:8081/xgj/gzfw?qr=S0000009735859" },
                { name: "é…ç”µç®±", code: "S0000009735915", url: "https://zhxf.fj.119.gov.cn:8081/xgj/gzfw?qr=S0000009735915" }
            ],
            "ç”µæ³³è½¦é—´": [
                { name: "ç­ç«å™¨", code: "S0000009736225", url: "https://zhxf.fj.119.gov.cn:8081/xgj/gzfw?qr=S0000009736225" },
                { name: "æ¶ˆç«æ “", code: "S0000009735921", url: "https://zhxf.fj.119.gov.cn:8081/xgj/gzfw?qr=S0000009735921" },
                { name: "ç–æ•£é€šé“", code: "S0000009735920", url: "https://zhxf.fj.119.gov.cn:8081/xgj/gzfw?qr=S0000009735920" },
                { name: "åº”æ€¥ç…§æ˜", code: "S0000009735918", url: "https://zhxf.fj.119.gov.cn:8081/xgj/gzfw?qr=S0000009735918" }
            ],
            "ç„Šè£…è½¦é—´": [
                { name: "ç­ç«å™¨", code: "S0000009736224", url: "https://zhxf.fj.119.gov.cn:8081/xgj/gzfw?qr=S0000009736224" },
                { name: "å®‰å…¨å‡ºå£", code: "S0000009736273", url: "https://zhxf.fj.119.gov.cn:8081/xgj/gzfw?qr=S0000009736273" },
                { name: "ç–æ•£é€šé“", code: "S0000009735923", url: "https://zhxf.fj.119.gov.cn:8081/xgj/gzfw?qr=S0000009735923" }
            ],
            "æ¶‚è£…è½¦é—´": [
                { name: "ç­ç«å™¨", code: "S0000009736226", url: "https://zhxf.fj.119.gov.cn:8081/xgj/gzfw?qr=S0000009736226" },
                { name: "å®‰å…¨å‡ºå£", code: "S0000009735957", url: "https://zhxf.fj.119.gov.cn:8081/xgj/gzfw?qr=S0000009735957" },
                { name: "å¾®å‹æ¶ˆé˜²ç«™", code: "S0000009735956", url: "https://zhxf.fj.119.gov.cn:8081/xgj/gzfw?qr=S0000009735956" },
                { name: "æ¶ˆé˜²æ§åˆ¶å®¤", code: "S0000009735954", url: "https://zhxf.fj.119.gov.cn:8081/xgj/gzfw?qr=S0000009735954" }
            ],
            "æ±¡æ°´å¤„ç†ç«™": [
                { name: "ç­ç«å™¨", code: "S0000009736227", url: "https://zhxf.fj.119.gov.cn:8081/xgj/gzfw?qr=S0000009736227" },
                { name: "ç–æ•£æ¥¼æ¢¯", code: "S0000009736159", url: "https://zhxf.fj.119.gov.cn:8081/xgj/gzfw?qr=S0000009736159" }
            ],
            "è¯•åˆ¶è½¦é—´": [
                { name: "ç­ç«å™¨", code: "S0000009736230", url: "https://zhxf.fj.119.gov.cn:8081/xgj/gzfw?qr=S0000009736230" },
                { name: "å®‰å…¨å‡ºå£", code: "S0000009735935", url: "https://zhxf.fj.119.gov.cn:8081/xgj/gzfw?qr=S0000009735935" }
            ],
            "ç‰¹ç§æ¶‚è£…è½¦é—´": [
                { name: "ç­ç«å™¨", code: "S0000009736228", url: "https://zhxf.fj.119.gov.cn:8081/xgj/gzfw?qr=S0000009736228" },
                { name: "ç–æ•£æŒ‡ç¤º", code: "S0000009736119", url: "https://zhxf.fj.119.gov.cn:8081/xgj/gzfw?qr=S0000009736119" }
            ],
            "å……ç”µæ¡©": [
                { name: "ç­ç«å™¨", code: "S0000009736152", url: "https://zhxf.fj.119.gov.cn:8081/xgj/gzfw?qr=S0000009736152" },
                { name: "æ¶ˆç«æ “", code: "S0000009736151", url: "https://zhxf.fj.119.gov.cn:8081/xgj/gzfw?qr=S0000009736151" }
            ],
            "æ¸…æ´æ¥¼": [
                { name: "ç­ç«å™¨", code: "S0000009736240", url: "https://zhxf.fj.119.gov.cn:8081/xgj/gzfw?qr=S0000009736240" },
                { name: "é…ç”µç®±", code: "S0000009735942", url: "https://zhxf.fj.119.gov.cn:8081/xgj/gzfw?qr=S0000009735942" }
            ],
            "è”åˆåŠ¨åŠ›ç«™æˆ¿": [
                { name: "ç­ç«å™¨", code: "S0000009736229", url: "https://zhxf.fj.119.gov.cn:8081/xgj/gzfw?qr=S0000009736229" },
                { name: "é…ç”µç®±", code: "S0000009736168", url: "https://zhxf.fj.119.gov.cn:8081/xgj/gzfw?qr=S0000009736168" }
            ]
        };
        
        // å½“å‰çŠ¶æ€å˜é‡
        let selectedFacility = null;
        let currentFacilityCodes = [];
        let currentFacilityIndex = -1;
        let isFacilityMode = false;
        let currentBuildingName = '';
        
        // é¡µé¢åŠ è½½æ—¶åˆå§‹åŒ–
        document.addEventListener('DOMContentLoaded', function() {
            console.log('é¡µé¢åŠ è½½å®Œæˆ');
            
            // åˆå§‹åŒ–è½¦é—´é€‰æ‹©å¼¹çª—æŒ‰é’®
            initializeFacilityButtons();
            
            // ç»‘å®šäº‹ä»¶ç›‘å¬å™¨
            bindEventListeners();
        });
        
        // åˆå§‹åŒ–è½¦é—´é€‰æ‹©å¼¹çª—æŒ‰é’®
        function initializeFacilityButtons() {
            console.log('åˆå§‹åŒ–è½¦é—´æŒ‰é’®');
            facilities.forEach(facility => {
                const button = document.createElement('button');
                button.className = 'facility-btn';
                button.dataset.code = facility.code;
                button.dataset.name = facility.name;
                button.dataset.type = facility.type;
                
                // åˆ›å»ºæŒ‰é’®å†…å®¹
                const nameSpan = document.createElement('span');
                nameSpan.textContent = facility.name;
                
                const typeSpan = document.createElement('span');
                typeSpan.className = 'type-tag';
                typeSpan.textContent = facility.type;
                
                button.appendChild(nameSpan);
                button.appendChild(typeSpan);
                
                // ç‚¹å‡»ç›´æ¥è¿›å…¥äºŒç»´ç å±•ç¤ºé¡µé¢
                button.addEventListener('click', function() {
                    console.log('ç‚¹å‡»äº†è½¦é—´æŒ‰é’®:', this.dataset.name);
                    // è®¾ç½®å½“å‰é€‰æ‹©çš„è®¾æ–½
                    selectedFacility = {
                        name: this.dataset.name,
                        code: this.dataset.code,
                        type: this.dataset.type
                    };
                    
                    // å…³é—­è½¦é—´é€‰æ‹©å¼¹çª—ï¼Œæ˜¾ç¤ºä¸»å†…å®¹ï¼ˆäºŒç»´ç å±•ç¤ºé¡µé¢ï¼‰
                    facilityModal.classList.remove('active');
                    mainContainer.classList.add('active');
                    
                    // è®¾ç½®å½“å‰é€‰æ‹©çš„è®¾æ–½
                    currentBuildingName = selectedFacility.name;
                    currentFacilityCodes = facilityCodes[currentBuildingName] || [];
                    
                    // é‡ç½®è®¾æ–½æ¨¡å¼
                    isFacilityMode = false;
                    qrCodeContainer.classList.remove('facility-mode-active');
                    actionButtons.style.display = 'none';
                    instruction.textContent = 'ğŸ‘‰ğŸ» ç‚¹å‡»å±å¹•äºŒç»´ç åˆ‡æ¢åˆ°è®¾æ–½ç ';
                    
                    // æ›´æ–°äºŒç»´ç æ˜¾ç¤º
                    updateBuildingQRDisplay(selectedFacility.name, selectedFacility.code, selectedFacility.type);
                });
                
                facilityButtonsGrid.appendChild(button);
            });
        }
        
        // ç»‘å®šæ‰€æœ‰äº‹ä»¶ç›‘å¬å™¨
        function bindEventListeners() {
            console.log('ç»‘å®šäº‹ä»¶ç›‘å¬å™¨');
            
            // "å¼€å§‹å·¡æŸ¥ä»»åŠ¡"æŒ‰é’®ç‚¹å‡»äº‹ä»¶
            startInspectionBtn.addEventListener('click', function() {
                console.log('ç‚¹å‡»äº†å¼€å§‹å·¡æŸ¥ä»»åŠ¡æŒ‰é’®');
                // éšè—æ¬¢è¿å¼¹çª—ï¼Œæ˜¾ç¤ºè½¦é—´é€‰æ‹©å¼¹çª—
                welcomeModal.classList.add('hidden');
                facilityModal.classList.add('active');
            });
            
            // "ä¸Šä¸‹ç­æ‰“å¡"æŒ‰é’®ç‚¹å‡»äº‹ä»¶
            clockInOutBtn.addEventListener('click', function() {
                console.log('ç‚¹å‡»äº†ä¸Šä¸‹ç­æ‰“å¡æŒ‰é’®');
                // éšè—æ¬¢è¿å¼¹çª—ï¼Œæ˜¾ç¤ºæ‰“å¡å¼¹çª—
                welcomeModal.classList.add('hidden');
                clockModal.classList.add('active');
                
                // ç”Ÿæˆæ‰“å¡äºŒç»´ç 
                generateClockQRCode();
            });
            
            // å…³é—­æ‰“å¡å¼¹çª—æŒ‰é’®ç‚¹å‡»äº‹ä»¶
            closeClockModalBtn.addEventListener('click', function() {
                console.log('ç‚¹å‡»äº†å…³é—­æ‰“å¡å¼¹çª—æŒ‰é’®');
                // å…³é—­æ‰“å¡å¼¹çª—ï¼Œå›åˆ°æ¬¢è¿å¼¹çª—
                clockModal.classList.remove('active');
                welcomeModal.classList.remove('hidden');
            });
            
            // è½¦é—´é€‰æ‹©å¼¹çª—å…³é—­æŒ‰é’®ç‚¹å‡»äº‹ä»¶
            facilityCloseBtn.addEventListener('click', function() {
                console.log('ç‚¹å‡»äº†è½¦é—´å¼¹çª—å…³é—­æŒ‰é’®');
                // å…³é—­è½¦é—´é€‰æ‹©å¼¹çª—ï¼Œå›åˆ°æ¬¢è¿å¼¹çª—
                facilityModal.classList.remove('active');
                welcomeModal.classList.remove('hidden');
            });
            
            // äºŒç»´ç å±•ç¤ºé¡µé¢è¿”å›æŒ‰é’®ç‚¹å‡»äº‹ä»¶
            backToFacilityBtn.addEventListener('click', function() {
                console.log('ç‚¹å‡»äº†è¿”å›é€‰æ‹©æŒ‰é’®');
                // éšè—ä¸»å†…å®¹ï¼Œæ˜¾ç¤ºè½¦é—´é€‰æ‹©å¼¹çª—
                mainContainer.classList.remove('active');
                facilityModal.classList.add('active');
            });
            
            // äºŒç»´ç å®¹å™¨ç‚¹å‡»äº‹ä»¶ - è¿›å…¥è®¾æ–½ç æ¨¡å¼
            qrCodeContainer.addEventListener('click', function() {
                console.log('ç‚¹å‡»äº†äºŒç»´ç å®¹å™¨');
                
                if (!currentBuildingName) {
                    alert('è¯·å…ˆé€‰æ‹©ä¸€ä¸ªè½¦é—´æˆ–è®¾æ–½');
                    return;
                }
                
                if (currentFacilityCodes.length === 0) {
                    alert('å½“å‰é€‰æ‹©çš„éƒ¨ä½æš‚æ— è®¾æ–½ç ä¿¡æ¯');
                    return;
                }
                
                showFacilityQRCode();
                
                // æ»šåŠ¨åˆ°é¡¶éƒ¨ï¼Œç¡®ä¿äºŒç»´ç å¯è§
                window.scrollTo({ top: 0, behavior: 'smooth' });
            });
            
            // ä¸‹ä¸€ä¸ªæŒ‰é’®ç‚¹å‡»äº‹ä»¶
            nextBtn.addEventListener('click', showNextFacilityCode);
        }
        
        // ç”Ÿæˆæ‰“å¡äºŒç»´ç 
        function generateClockQRCode() {
            console.log('ç”Ÿæˆæ‰“å¡äºŒç»´ç ');
            // æ›´æ–°æ–‡æœ¬ä¿¡æ¯
            clockCodeText.textContent = CLOCK_QR_CODE;
            clockUrlText.textContent = CLOCK_QR_URL;
            
            // ç”ŸæˆQRç å›¾ç‰‡
            const qrSize = 250;
            const qrUrl = `https://api.qrserver.com/v1/create-qr-code/?size=${qrSize}x${qrSize}&data=${encodeURIComponent(CLOCK_QR_URL)}`;
            
            // åˆ›å»ºå›¾ç‰‡
            const img = new Image();
            img.alt = "ä¸Šä¸‹ç­æ‰“å¡äºŒç»´ç ";
            
            // å›¾ç‰‡åŠ è½½æˆåŠŸ
            img.onload = function() {
                clockQrPlaceholder.innerHTML = '';
                clockQrPlaceholder.appendChild(img);
                console.log('æ‰“å¡äºŒç»´ç åŠ è½½æˆåŠŸ');
            };
            
            // å›¾ç‰‡åŠ è½½å¤±è´¥
            img.onerror = function() {
                clockQrPlaceholder.innerHTML = '<p>æ— æ³•åŠ è½½äºŒç»´ç ï¼Œè¯·æ£€æŸ¥ç½‘ç»œè¿æ¥</p>';
                console.log('æ‰“å¡äºŒç»´ç åŠ è½½å¤±è´¥');
            };
            
            img.src = qrUrl;
        }
        
        // æ›´æ–°å»ºç­‘ç æ˜¾ç¤º
        function updateBuildingQRDisplay(name, code, type) {
            console.log('æ›´æ–°å»ºç­‘ç æ˜¾ç¤º:', name, code);
            qrTitle.textContent = name;
            qrCodeText.textContent = code;
            
            // æ„å»ºå®Œæ•´çš„URL
            const fullUrl = BASE_QR_URL + code;
            qrUrlText.textContent = fullUrl;
            
            // æ˜¾ç¤ºåŠ è½½çŠ¶æ€
            qrImage.innerHTML = '<div class="loading-spinner"></div><p>æ­£åœ¨ç”ŸæˆäºŒç»´ç ...</p>';
            qrImage.className = 'loading';
            
            // åˆ›å»ºQRç å›¾ç‰‡
            const img = new Image();
            img.alt = `${name}äºŒç»´ç `;
            
            // è®¾ç½®å›¾ç‰‡åŠ è½½å®Œæˆçš„å›è°ƒ
            img.onload = function() {
                qrImage.innerHTML = '';
                qrImage.appendChild(img);
                
                // ç§»é™¤åŠ è½½ç±»
                qrImage.classList.remove('loading');
                console.log('å»ºç­‘ç äºŒç»´ç åŠ è½½æˆåŠŸ');
            };
            
            // è®¾ç½®å›¾ç‰‡åŠ è½½é”™è¯¯çš„å›è°ƒ
            img.onerror = function() {
                qrImage.innerHTML = '<p>æ— æ³•åŠ è½½äºŒç»´ç ï¼Œè¯·æ£€æŸ¥ç½‘ç»œè¿æ¥</p>';
                qrImage.classList.remove('loading');
                console.log('å»ºç­‘ç äºŒç»´ç åŠ è½½å¤±è´¥');
            };
            
            // ä½¿ç”¨ç¬¬ä¸‰æ–¹APIç”ŸæˆQRç ï¼Œç¼–ç å®Œæ•´çš„URL
            const qrSize = 250;
            const qrUrl = `https://api.qrserver.com/v1/create-qr-code/?size=${qrSize}x${qrSize}&data=${encodeURIComponent(fullUrl)}`;
            
            img.src = qrUrl;
        }
        
        // æ˜¾ç¤ºè®¾æ–½ç 
        function showFacilityQRCode() {
            console.log('æ˜¾ç¤ºè®¾æ–½ç ');
            if (currentFacilityCodes.length === 0) {
                alert('å½“å‰é€‰æ‹©çš„éƒ¨ä½æš‚æ— è®¾æ–½ç ä¿¡æ¯');
                return;
            }
            
            // å¦‚æœæ˜¯ç¬¬ä¸€æ¬¡è¿›å…¥è®¾æ–½æ¨¡å¼ï¼Œé‡ç½®ç´¢å¼•
            if (!isFacilityMode) {
                currentFacilityIndex = 0;
                isFacilityMode = true;
                qrCodeContainer.classList.add('facility-mode-active');
                actionButtons.style.display = 'flex';
            }
            
            // è·å–å½“å‰è®¾æ–½ç 
            const facilityCode = currentFacilityCodes[currentFacilityIndex];
            
            // æ›´æ–°æ˜¾ç¤º
            instruction.textContent = `è®¾æ–½ç  ${currentFacilityIndex + 1}/${currentFacilityCodes.length}`;
            qrTitle.textContent = `${currentBuildingName} - ${facilityCode.name}`;
            qrCodeText.textContent = facilityCode.code;
            qrUrlText.textContent = facilityCode.url;
            
            // æ˜¾ç¤ºåŠ è½½çŠ¶æ€
            qrImage.innerHTML = '<div class="loading-spinner"></div><p>æ­£åœ¨ç”ŸæˆäºŒç»´ç ...</p>';
            qrImage.className = 'loading';
            
            // åˆ›å»ºQRç å›¾ç‰‡
            const img = new Image();
            img.alt = `${facilityCode.name}äºŒç»´ç `;
            
            // è®¾ç½®å›¾ç‰‡åŠ è½½å®Œæˆçš„å›è°ƒ
            img.onload = function() {
                qrImage.innerHTML = '';
                qrImage.appendChild(img);
                
                // ç§»é™¤åŠ è½½ç±»
                qrImage.classList.remove('loading');
                console.log('è®¾æ–½ç äºŒç»´ç åŠ è½½æˆåŠŸ');
            };
            
            // è®¾ç½®å›¾ç‰‡åŠ è½½é”™è¯¯çš„å›è°ƒ
            img.onerror = function() {
                qrImage.innerHTML = '<p>æ— æ³•åŠ è½½äºŒç»´ç ï¼Œè¯·æ£€æŸ¥ç½‘ç»œè¿æ¥</p>';
                qrImage.classList.remove('loading');
                console.log('è®¾æ–½ç äºŒç»´ç åŠ è½½å¤±è´¥');
            };
            
            // ä½¿ç”¨ç¬¬ä¸‰æ–¹APIç”ŸæˆQRç 
            const qrSize = 250;
            const qrUrl = `https://api.qrserver.com/v1/create-qr-code/?size=${qrSize}x${qrSize}&data=${encodeURIComponent(facilityCode.url)}`;
            
            img.src = qrUrl;
        }
        
        // æ˜¾ç¤ºä¸‹ä¸€ä¸ªè®¾æ–½ç 
        function showNextFacilityCode() {
            console.log('æ˜¾ç¤ºä¸‹ä¸€ä¸ªè®¾æ–½ç ');
            if (currentFacilityCodes.length === 0 || !isFacilityMode) {
                return;
            }
            
            // æ›´æ–°ç´¢å¼•ï¼ˆå¾ªç¯ï¼‰
            currentFacilityIndex = (currentFacilityIndex + 1) % currentFacilityCodes.length;
            
            // æ˜¾ç¤ºæ–°çš„è®¾æ–½ç 
            showFacilityQRCode();
            
            // æ»šåŠ¨åˆ°é¡¶éƒ¨ï¼Œç¡®ä¿äºŒç»´ç å¯è§
            window.scrollTo({ top: 0, behavior: 'smooth' });
        }
    </script>
</body>
</html>